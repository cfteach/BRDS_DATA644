
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Assignment 2 &#8212; Bayesian Reasoning in Data Science (DATA 644)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/wm_vertical_single_line_full_color.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="referencesmd.html" />
    <link rel="prev" title="DATA 644 (Bayesian Reasoning in Data Science): Assignment 1" href="Sol_assignment1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/wm_vertical_single_line_full_color.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Bayesian Reasoning in Data Science (DATA 644)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Bayesian Reasoning in Data Science (PhD Course)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures (integrate with notebooks below)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1uXlxQoqseWwwurtU-HSbqEz6EvE-r4ZSPorJU8kmFgw/edit?usp=sharing">
   Bayes Theorem, priors, likelihood, posterior, distributions - Lec 1 (1/25/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1A46CUs7thqx5qPV91fdywdkl0nQx_PWhokTif0Rmf_8/edit?usp=sharing">
   Bayes Theorem, subjective and objective interpretations of probability, Exercises - Lec 2 (1/30/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1r1Np-VjDTCLCmaynoOBaCel3W40bZvj9lQBlY6zfggc/edit?usp=sharing">
   Thinking Probabilistically, Causes and Effects , True and Measured; Credible Intervals, ROPE, HDI - Lec 3 (2/1/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1_GlPlOWiB9HGNph6jKFfHdZjP7tm70WiqsmEZeUcC-E/edit?usp=sharing">
   Inference and Intro to Probabilistic Programming, PyMC; Credible Intervals, ROPE, HDI - Lec 4 (2/6/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1xwxp7steeZfhyNR1OAtRSWR1Qnx0OKVfA0WvpHNR-CM/edit?usp=sharing">
   Inference and Intro to Probabilistic Programming, PyMC; Credible Intervals, ROPE, HDI - Lec 5 (2/8/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1J0j8Y3S0gcGLL-9JsUuQEpZ1J-YU6bZKM_GJ4M_7_jA/edit?usp=sharing">
   Gaussian Inference; t-Student; Update of Beliefs - Lec 6 (2/13/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1nFAnk_s-SVPVRUs-r4MdxR-KTCknRhwJwHQpgoiqZHk/edit?usp=sharing">
   Bayesian Linear Regression; Robust Regression - Lec 7 (2/15/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1Na_htl6xFF9Td-giuBGRjnsdZUX8pVnq0wCS7qzk9WA/edit?usp=sharing">
   Bayesian Polynomial Regression, Posterior Predictive Checks - Lec 8 (2/20/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1JqfptaCn1qGk18gEGvfnk3GoO3U5Xtz1nNtJh1rBX5U/edit?usp=sharing">
   Bayesian Logistic Regression and Softmax - Lec 9 (2/22/2024), Lec 10 (2/27/2024), Lec 11 (2/29/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1oFcM9T3RIDgvRShnSzEsvqOCha8OH8c_vd60n7cLHOI/edit?usp=sharing">
   Bayesian Model Comparison and Information Criteria -  Lec 12 (3/5/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/presentation/d/1DMbpCpt4qUHdHjZ_VOB2UvUiavL2-BPU-4EvGjDBL68/edit?usp=sharing">
   Bayes Factors, sequential MC - Lec 13 (3/7/2024)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="MontyHall_MC.html">
   Bayes Theorem (2/1/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Intro_Bayes.html">
   Thinking Probabilistically (2/1/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Intro_PyMC4.html">
   Intro to Probabilistic Programming (2/6/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Intro_MCMC.html">
   An (Over-)Simplified Intro to MCMC (2/8/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Gaussian_Inferences.html">
   Bayesian Inference with Gaussian and t-Student models, update of beliefs (2/13/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Bayesian_Linear_Regression2.html">
   Bayesian Linear Regression; Robust Inference (2/15/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Bayesian_Polynomial_Regression.html">
   Bayesian Polynomial Regression, Posterior Predictive Checks and Comparison with Observations (2/20/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Bayesian_Logistic_Regression.html">
   Bayesian Logistic Regression (2/22/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Bayesian_Softmax.html">
   Bayesian Softmax (2/27/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Model_Comparison.html">
   Model Comparison, Information Criteria (3/5/2024)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Bayes_Factors.html">
   Model Comparison, Bayes Factors (3/7/2024)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://drive.google.com/file/d/1WRx6z70xiTeizudRDfY5EIrVRG893CcS/view?usp=sharing">
   Assignment 1 - PDF (Questions 1 and 3)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Sol_assignment1.html">
   Assignment 1 - notebook (Question 2)
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Assignment 2 - notebook (All Questions)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Question and Answers
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://docs.google.com/document/d/1D3qSpwsDQE9I44s9d9YiSepVw4gPmae0g7DjGtD4xbA/edit?usp=sharing">
   Q&amp;A Shared Google Doc (used in class)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Projects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://cfteach.github.io/pyscr/">
   Mini-project (pyscript + PyMC)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://cfteach.github.io/brds/bayesian_A_B_testing_mini_project.html">
   Bayesian A/B testing (pyscript) by R. Gupta, BRDS class 2022
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Additional resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="referencesmd.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/cfteach/BRDS_DATA644/main?urlpath=tree/notebooks/Sol_assignment2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="http://jupyterhub.wm.edu/hub/user-redirect/git-pull?repo=https://github.com/cfteach/BRDS_DATA644&urlpath=tree/BRDS_DATA644/notebooks/Sol_assignment2.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/cfteach/BRDS_DATA644/blob/main/notebooks/Sol_assignment2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/cfteach/BRDS_DATA644"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/cfteach/BRDS_DATA644/issues/new?title=Issue%20on%20page%20%2FSol_assignment2.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Sol_assignment2.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-1">
   Question 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-the-model">
     Building the model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predictions-on-test-data">
     Predictions on test data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis-on-training-data">
     Analysis on Training Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#isolate-the-misidentified-events">
     Isolate the misidentified events
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-those-events">
     Filtering those events
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-pca">
     Using PCA
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis-on-standardized-and-pca-reduced-data">
     Analysis on standardized and PCA-reduced data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualization-of-uncertainty-band">
     Visualization of Uncertainty Band
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-events">
     Filtering Events
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Assignment 2</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-1">
   Question 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-the-model">
     Building the model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predictions-on-test-data">
     Predictions on test data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis-on-training-data">
     Analysis on Training Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#isolate-the-misidentified-events">
     Isolate the misidentified events
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-those-events">
     Filtering those events
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-pca">
     Using PCA
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis-on-standardized-and-pca-reduced-data">
     Analysis on standardized and PCA-reduced data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualization-of-uncertainty-band">
     Visualization of Uncertainty Band
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-events">
     Filtering Events
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="assignment-2">
<h1>Assignment 2<a class="headerlink" href="#assignment-2" title="Permalink to this headline">#</a></h1>
<hr class="docutils" />
<section id="question-1">
<h2>Question 1<a class="headerlink" href="#question-1" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pytensor</span> <span class="n">pymc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pytensor in /usr/local/lib/python3.10/dist-packages (2.14.2)
Requirement already satisfied: pymc in /usr/local/lib/python3.10/dist-packages (5.7.2)
Requirement already satisfied: setuptools&gt;=48.0.0 in /usr/local/lib/python3.10/dist-packages (from pytensor) (67.7.2)
Requirement already satisfied: scipy&gt;=0.14 in /usr/local/lib/python3.10/dist-packages (from pytensor) (1.11.4)
Requirement already satisfied: numpy&gt;=1.17.0 in /usr/local/lib/python3.10/dist-packages (from pytensor) (1.25.2)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from pytensor) (3.13.1)
Requirement already satisfied: etuples in /usr/local/lib/python3.10/dist-packages (from pytensor) (0.3.9)
Requirement already satisfied: logical-unification in /usr/local/lib/python3.10/dist-packages (from pytensor) (0.4.6)
Requirement already satisfied: miniKanren in /usr/local/lib/python3.10/dist-packages (from pytensor) (1.0.3)
Requirement already satisfied: cons in /usr/local/lib/python3.10/dist-packages (from pytensor) (0.4.6)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from pytensor) (4.9.0)
Requirement already satisfied: arviz&gt;=0.13.0 in /usr/local/lib/python3.10/dist-packages (from pymc) (0.15.1)
Requirement already satisfied: cachetools&gt;=4.2.1 in /usr/local/lib/python3.10/dist-packages (from pymc) (5.3.2)
Requirement already satisfied: cloudpickle in /usr/local/lib/python3.10/dist-packages (from pymc) (2.2.1)
Requirement already satisfied: fastprogress&gt;=0.2.0 in /usr/local/lib/python3.10/dist-packages (from pymc) (1.0.3)
Requirement already satisfied: pandas&gt;=0.24.0 in /usr/local/lib/python3.10/dist-packages (from pymc) (1.5.3)
Requirement already satisfied: matplotlib&gt;=3.2 in /usr/local/lib/python3.10/dist-packages (from arviz&gt;=0.13.0-&gt;pymc) (3.7.1)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from arviz&gt;=0.13.0-&gt;pymc) (23.2)
Requirement already satisfied: xarray&gt;=0.21.0 in /usr/local/lib/python3.10/dist-packages (from arviz&gt;=0.13.0-&gt;pymc) (2023.7.0)
Requirement already satisfied: h5netcdf&gt;=1.0.2 in /usr/local/lib/python3.10/dist-packages (from arviz&gt;=0.13.0-&gt;pymc) (1.3.0)
Requirement already satisfied: xarray-einstats&gt;=0.3 in /usr/local/lib/python3.10/dist-packages (from arviz&gt;=0.13.0-&gt;pymc) (0.7.0)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=0.24.0-&gt;pymc) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas&gt;=0.24.0-&gt;pymc) (2023.4)
Requirement already satisfied: toolz in /usr/local/lib/python3.10/dist-packages (from logical-unification-&gt;pytensor) (0.12.1)
Requirement already satisfied: multipledispatch in /usr/local/lib/python3.10/dist-packages (from logical-unification-&gt;pytensor) (1.0.0)
Requirement already satisfied: h5py in /usr/local/lib/python3.10/dist-packages (from h5netcdf&gt;=1.0.2-&gt;arviz&gt;=0.13.0-&gt;pymc) (3.9.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.2-&gt;arviz&gt;=0.13.0-&gt;pymc) (1.2.0)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.2-&gt;arviz&gt;=0.13.0-&gt;pymc) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.2-&gt;arviz&gt;=0.13.0-&gt;pymc) (4.49.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.2-&gt;arviz&gt;=0.13.0-&gt;pymc) (1.4.5)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.2-&gt;arviz&gt;=0.13.0-&gt;pymc) (9.4.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.2-&gt;arviz&gt;=0.13.0-&gt;pymc) (3.1.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.1-&gt;pandas&gt;=0.24.0-&gt;pymc) (1.16.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="n">cancer1</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predictors: &quot;</span><span class="p">,</span> <span class="n">cancer1</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Predictors:  [&#39;mean radius&#39; &#39;mean texture&#39; &#39;mean perimeter&#39; &#39;mean area&#39;
 &#39;mean smoothness&#39; &#39;mean compactness&#39; &#39;mean concavity&#39;
 &#39;mean concave points&#39; &#39;mean symmetry&#39; &#39;mean fractal dimension&#39;
 &#39;radius error&#39; &#39;texture error&#39; &#39;perimeter error&#39; &#39;area error&#39;
 &#39;smoothness error&#39; &#39;compactness error&#39; &#39;concavity error&#39;
 &#39;concave points error&#39; &#39;symmetry error&#39; &#39;fractal dimension error&#39;
 &#39;worst radius&#39; &#39;worst texture&#39; &#39;worst perimeter&#39; &#39;worst area&#39;
 &#39;worst smoothness&#39; &#39;worst compactness&#39; &#39;worst concavity&#39;
 &#39;worst concave points&#39; &#39;worst symmetry&#39; &#39;worst fractal dimension&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">cancer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cancer1</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cancer1</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">cancer</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cancer</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>

<span class="n">cancer</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(569, 30)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cancer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-2aed8ab9-b9d5-4203-8ebb-22abf5d55e5d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_radius</th>
      <th>mean_texture</th>
      <th>mean_perimeter</th>
      <th>mean_area</th>
      <th>mean_smoothness</th>
      <th>mean_compactness</th>
      <th>mean_concavity</th>
      <th>mean_concave_points</th>
      <th>mean_symmetry</th>
      <th>mean_fractal_dimension</th>
      <th>...</th>
      <th>worst_radius</th>
      <th>worst_texture</th>
      <th>worst_perimeter</th>
      <th>worst_area</th>
      <th>worst_smoothness</th>
      <th>worst_compactness</th>
      <th>worst_concavity</th>
      <th>worst_concave_points</th>
      <th>worst_symmetry</th>
      <th>worst_fractal_dimension</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17.99</td>
      <td>10.38</td>
      <td>122.80</td>
      <td>1001.0</td>
      <td>0.11840</td>
      <td>0.27760</td>
      <td>0.30010</td>
      <td>0.14710</td>
      <td>0.2419</td>
      <td>0.07871</td>
      <td>...</td>
      <td>25.380</td>
      <td>17.33</td>
      <td>184.60</td>
      <td>2019.0</td>
      <td>0.16220</td>
      <td>0.66560</td>
      <td>0.7119</td>
      <td>0.2654</td>
      <td>0.4601</td>
      <td>0.11890</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20.57</td>
      <td>17.77</td>
      <td>132.90</td>
      <td>1326.0</td>
      <td>0.08474</td>
      <td>0.07864</td>
      <td>0.08690</td>
      <td>0.07017</td>
      <td>0.1812</td>
      <td>0.05667</td>
      <td>...</td>
      <td>24.990</td>
      <td>23.41</td>
      <td>158.80</td>
      <td>1956.0</td>
      <td>0.12380</td>
      <td>0.18660</td>
      <td>0.2416</td>
      <td>0.1860</td>
      <td>0.2750</td>
      <td>0.08902</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19.69</td>
      <td>21.25</td>
      <td>130.00</td>
      <td>1203.0</td>
      <td>0.10960</td>
      <td>0.15990</td>
      <td>0.19740</td>
      <td>0.12790</td>
      <td>0.2069</td>
      <td>0.05999</td>
      <td>...</td>
      <td>23.570</td>
      <td>25.53</td>
      <td>152.50</td>
      <td>1709.0</td>
      <td>0.14440</td>
      <td>0.42450</td>
      <td>0.4504</td>
      <td>0.2430</td>
      <td>0.3613</td>
      <td>0.08758</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11.42</td>
      <td>20.38</td>
      <td>77.58</td>
      <td>386.1</td>
      <td>0.14250</td>
      <td>0.28390</td>
      <td>0.24140</td>
      <td>0.10520</td>
      <td>0.2597</td>
      <td>0.09744</td>
      <td>...</td>
      <td>14.910</td>
      <td>26.50</td>
      <td>98.87</td>
      <td>567.7</td>
      <td>0.20980</td>
      <td>0.86630</td>
      <td>0.6869</td>
      <td>0.2575</td>
      <td>0.6638</td>
      <td>0.17300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20.29</td>
      <td>14.34</td>
      <td>135.10</td>
      <td>1297.0</td>
      <td>0.10030</td>
      <td>0.13280</td>
      <td>0.19800</td>
      <td>0.10430</td>
      <td>0.1809</td>
      <td>0.05883</td>
      <td>...</td>
      <td>22.540</td>
      <td>16.67</td>
      <td>152.20</td>
      <td>1575.0</td>
      <td>0.13740</td>
      <td>0.20500</td>
      <td>0.4000</td>
      <td>0.1625</td>
      <td>0.2364</td>
      <td>0.07678</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>564</th>
      <td>21.56</td>
      <td>22.39</td>
      <td>142.00</td>
      <td>1479.0</td>
      <td>0.11100</td>
      <td>0.11590</td>
      <td>0.24390</td>
      <td>0.13890</td>
      <td>0.1726</td>
      <td>0.05623</td>
      <td>...</td>
      <td>25.450</td>
      <td>26.40</td>
      <td>166.10</td>
      <td>2027.0</td>
      <td>0.14100</td>
      <td>0.21130</td>
      <td>0.4107</td>
      <td>0.2216</td>
      <td>0.2060</td>
      <td>0.07115</td>
    </tr>
    <tr>
      <th>565</th>
      <td>20.13</td>
      <td>28.25</td>
      <td>131.20</td>
      <td>1261.0</td>
      <td>0.09780</td>
      <td>0.10340</td>
      <td>0.14400</td>
      <td>0.09791</td>
      <td>0.1752</td>
      <td>0.05533</td>
      <td>...</td>
      <td>23.690</td>
      <td>38.25</td>
      <td>155.00</td>
      <td>1731.0</td>
      <td>0.11660</td>
      <td>0.19220</td>
      <td>0.3215</td>
      <td>0.1628</td>
      <td>0.2572</td>
      <td>0.06637</td>
    </tr>
    <tr>
      <th>566</th>
      <td>16.60</td>
      <td>28.08</td>
      <td>108.30</td>
      <td>858.1</td>
      <td>0.08455</td>
      <td>0.10230</td>
      <td>0.09251</td>
      <td>0.05302</td>
      <td>0.1590</td>
      <td>0.05648</td>
      <td>...</td>
      <td>18.980</td>
      <td>34.12</td>
      <td>126.70</td>
      <td>1124.0</td>
      <td>0.11390</td>
      <td>0.30940</td>
      <td>0.3403</td>
      <td>0.1418</td>
      <td>0.2218</td>
      <td>0.07820</td>
    </tr>
    <tr>
      <th>567</th>
      <td>20.60</td>
      <td>29.33</td>
      <td>140.10</td>
      <td>1265.0</td>
      <td>0.11780</td>
      <td>0.27700</td>
      <td>0.35140</td>
      <td>0.15200</td>
      <td>0.2397</td>
      <td>0.07016</td>
      <td>...</td>
      <td>25.740</td>
      <td>39.42</td>
      <td>184.60</td>
      <td>1821.0</td>
      <td>0.16500</td>
      <td>0.86810</td>
      <td>0.9387</td>
      <td>0.2650</td>
      <td>0.4087</td>
      <td>0.12400</td>
    </tr>
    <tr>
      <th>568</th>
      <td>7.76</td>
      <td>24.54</td>
      <td>47.92</td>
      <td>181.0</td>
      <td>0.05263</td>
      <td>0.04362</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.1587</td>
      <td>0.05884</td>
      <td>...</td>
      <td>9.456</td>
      <td>30.37</td>
      <td>59.16</td>
      <td>268.6</td>
      <td>0.08996</td>
      <td>0.06444</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.2871</td>
      <td>0.07039</td>
    </tr>
  </tbody>
</table>
<p>569 rows Ã— 30 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2aed8ab9-b9d5-4203-8ebb-22abf5d55e5d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2aed8ab9-b9d5-4203-8ebb-22abf5d55e5d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2aed8ab9-b9d5-4203-8ebb-22abf5d55e5d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-19d2c73f-832a-46df-bb2b-749982a398a7">
  <button class="colab-df-quickchart" onclick="quickchart('df-19d2c73f-832a-46df-bb2b-749982a398a7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-19d2c73f-832a-46df-bb2b-749982a398a7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a column for the response variable: malignant or benign</span>
<span class="n">cancer</span><span class="p">[</span><span class="s1">&#39;Target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cancer1</span><span class="o">.</span><span class="n">target</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cancer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c0815fb7-8488-412a-b213-bd2a2128e6a3" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_radius</th>
      <th>mean_texture</th>
      <th>mean_perimeter</th>
      <th>mean_area</th>
      <th>mean_smoothness</th>
      <th>mean_compactness</th>
      <th>mean_concavity</th>
      <th>mean_concave_points</th>
      <th>mean_symmetry</th>
      <th>mean_fractal_dimension</th>
      <th>...</th>
      <th>worst_texture</th>
      <th>worst_perimeter</th>
      <th>worst_area</th>
      <th>worst_smoothness</th>
      <th>worst_compactness</th>
      <th>worst_concavity</th>
      <th>worst_concave_points</th>
      <th>worst_symmetry</th>
      <th>worst_fractal_dimension</th>
      <th>Target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17.99</td>
      <td>10.38</td>
      <td>122.80</td>
      <td>1001.0</td>
      <td>0.11840</td>
      <td>0.27760</td>
      <td>0.30010</td>
      <td>0.14710</td>
      <td>0.2419</td>
      <td>0.07871</td>
      <td>...</td>
      <td>17.33</td>
      <td>184.60</td>
      <td>2019.0</td>
      <td>0.16220</td>
      <td>0.66560</td>
      <td>0.7119</td>
      <td>0.2654</td>
      <td>0.4601</td>
      <td>0.11890</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20.57</td>
      <td>17.77</td>
      <td>132.90</td>
      <td>1326.0</td>
      <td>0.08474</td>
      <td>0.07864</td>
      <td>0.08690</td>
      <td>0.07017</td>
      <td>0.1812</td>
      <td>0.05667</td>
      <td>...</td>
      <td>23.41</td>
      <td>158.80</td>
      <td>1956.0</td>
      <td>0.12380</td>
      <td>0.18660</td>
      <td>0.2416</td>
      <td>0.1860</td>
      <td>0.2750</td>
      <td>0.08902</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19.69</td>
      <td>21.25</td>
      <td>130.00</td>
      <td>1203.0</td>
      <td>0.10960</td>
      <td>0.15990</td>
      <td>0.19740</td>
      <td>0.12790</td>
      <td>0.2069</td>
      <td>0.05999</td>
      <td>...</td>
      <td>25.53</td>
      <td>152.50</td>
      <td>1709.0</td>
      <td>0.14440</td>
      <td>0.42450</td>
      <td>0.4504</td>
      <td>0.2430</td>
      <td>0.3613</td>
      <td>0.08758</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11.42</td>
      <td>20.38</td>
      <td>77.58</td>
      <td>386.1</td>
      <td>0.14250</td>
      <td>0.28390</td>
      <td>0.24140</td>
      <td>0.10520</td>
      <td>0.2597</td>
      <td>0.09744</td>
      <td>...</td>
      <td>26.50</td>
      <td>98.87</td>
      <td>567.7</td>
      <td>0.20980</td>
      <td>0.86630</td>
      <td>0.6869</td>
      <td>0.2575</td>
      <td>0.6638</td>
      <td>0.17300</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20.29</td>
      <td>14.34</td>
      <td>135.10</td>
      <td>1297.0</td>
      <td>0.10030</td>
      <td>0.13280</td>
      <td>0.19800</td>
      <td>0.10430</td>
      <td>0.1809</td>
      <td>0.05883</td>
      <td>...</td>
      <td>16.67</td>
      <td>152.20</td>
      <td>1575.0</td>
      <td>0.13740</td>
      <td>0.20500</td>
      <td>0.4000</td>
      <td>0.1625</td>
      <td>0.2364</td>
      <td>0.07678</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>564</th>
      <td>21.56</td>
      <td>22.39</td>
      <td>142.00</td>
      <td>1479.0</td>
      <td>0.11100</td>
      <td>0.11590</td>
      <td>0.24390</td>
      <td>0.13890</td>
      <td>0.1726</td>
      <td>0.05623</td>
      <td>...</td>
      <td>26.40</td>
      <td>166.10</td>
      <td>2027.0</td>
      <td>0.14100</td>
      <td>0.21130</td>
      <td>0.4107</td>
      <td>0.2216</td>
      <td>0.2060</td>
      <td>0.07115</td>
      <td>0</td>
    </tr>
    <tr>
      <th>565</th>
      <td>20.13</td>
      <td>28.25</td>
      <td>131.20</td>
      <td>1261.0</td>
      <td>0.09780</td>
      <td>0.10340</td>
      <td>0.14400</td>
      <td>0.09791</td>
      <td>0.1752</td>
      <td>0.05533</td>
      <td>...</td>
      <td>38.25</td>
      <td>155.00</td>
      <td>1731.0</td>
      <td>0.11660</td>
      <td>0.19220</td>
      <td>0.3215</td>
      <td>0.1628</td>
      <td>0.2572</td>
      <td>0.06637</td>
      <td>0</td>
    </tr>
    <tr>
      <th>566</th>
      <td>16.60</td>
      <td>28.08</td>
      <td>108.30</td>
      <td>858.1</td>
      <td>0.08455</td>
      <td>0.10230</td>
      <td>0.09251</td>
      <td>0.05302</td>
      <td>0.1590</td>
      <td>0.05648</td>
      <td>...</td>
      <td>34.12</td>
      <td>126.70</td>
      <td>1124.0</td>
      <td>0.11390</td>
      <td>0.30940</td>
      <td>0.3403</td>
      <td>0.1418</td>
      <td>0.2218</td>
      <td>0.07820</td>
      <td>0</td>
    </tr>
    <tr>
      <th>567</th>
      <td>20.60</td>
      <td>29.33</td>
      <td>140.10</td>
      <td>1265.0</td>
      <td>0.11780</td>
      <td>0.27700</td>
      <td>0.35140</td>
      <td>0.15200</td>
      <td>0.2397</td>
      <td>0.07016</td>
      <td>...</td>
      <td>39.42</td>
      <td>184.60</td>
      <td>1821.0</td>
      <td>0.16500</td>
      <td>0.86810</td>
      <td>0.9387</td>
      <td>0.2650</td>
      <td>0.4087</td>
      <td>0.12400</td>
      <td>0</td>
    </tr>
    <tr>
      <th>568</th>
      <td>7.76</td>
      <td>24.54</td>
      <td>47.92</td>
      <td>181.0</td>
      <td>0.05263</td>
      <td>0.04362</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.1587</td>
      <td>0.05884</td>
      <td>...</td>
      <td>30.37</td>
      <td>59.16</td>
      <td>268.6</td>
      <td>0.08996</td>
      <td>0.06444</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.2871</td>
      <td>0.07039</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>569 rows Ã— 31 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c0815fb7-8488-412a-b213-bd2a2128e6a3')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c0815fb7-8488-412a-b213-bd2a2128e6a3 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c0815fb7-8488-412a-b213-bd2a2128e6a3');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3d43ad37-40af-4dd1-835d-0b9e3511afd5">
  <button class="colab-df-quickchart" onclick="quickchart('df-3d43ad37-40af-4dd1-835d-0b9e3511afd5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3d43ad37-40af-4dd1-835d-0b9e3511afd5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cancer</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(569, 31)
</pre></div>
</div>
</div>
</div>
<p>Next, we will split up our predictor and response data into training datasets and testing datasets. Recall, we will use the training dataset to train our logistic regression models and then use the testing dataset to test the accuracy of model predictions. There is a nice function from sklearn.model_selection called train_test_split that splits a given dataset into 75% training and 25% testing data. Stetting random_state=123 allows you to generate the same random train and test subsets used in this article. Itâ€™s not strictly necessary to split data into training and testing sets when performing logistic regression. In fact if you have limited data itâ€™s not wise to do. However, we do it in this article to demonstrate how each method leads to the same results.
For the logistic regression examples, we will model malignant or benign as a function of the first 10 predictors (columns) in our dataset. These first 10 correspond to mean measurements of each tumor; mean radius, mean texture, mean perimeter, mean area, etc. (We selected these 10 columns purely for convenience to limit output. The goal of this article is to present different ways of performing logistic regression in Python, not how to select variables.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Select the first 10 columns of our DataFrame that we will use as the predictors in our models</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">10</span><span class="p">]</span>

<span class="c1"># Select the response column</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cancer</span><span class="o">.</span><span class="n">Target</span>


<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Split these data into training and testing datasets</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new DataFrame by concatenating x and y</span>
<span class="n">new_dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">new_dataset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-790ce0e7-6241-4622-82f9-34451b6fb4f8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_radius</th>
      <th>mean_texture</th>
      <th>mean_perimeter</th>
      <th>mean_area</th>
      <th>mean_smoothness</th>
      <th>mean_compactness</th>
      <th>mean_concavity</th>
      <th>mean_concave_points</th>
      <th>mean_symmetry</th>
      <th>mean_fractal_dimension</th>
      <th>Target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17.99</td>
      <td>10.38</td>
      <td>122.80</td>
      <td>1001.0</td>
      <td>0.11840</td>
      <td>0.27760</td>
      <td>0.30010</td>
      <td>0.14710</td>
      <td>0.2419</td>
      <td>0.07871</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20.57</td>
      <td>17.77</td>
      <td>132.90</td>
      <td>1326.0</td>
      <td>0.08474</td>
      <td>0.07864</td>
      <td>0.08690</td>
      <td>0.07017</td>
      <td>0.1812</td>
      <td>0.05667</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19.69</td>
      <td>21.25</td>
      <td>130.00</td>
      <td>1203.0</td>
      <td>0.10960</td>
      <td>0.15990</td>
      <td>0.19740</td>
      <td>0.12790</td>
      <td>0.2069</td>
      <td>0.05999</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11.42</td>
      <td>20.38</td>
      <td>77.58</td>
      <td>386.1</td>
      <td>0.14250</td>
      <td>0.28390</td>
      <td>0.24140</td>
      <td>0.10520</td>
      <td>0.2597</td>
      <td>0.09744</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20.29</td>
      <td>14.34</td>
      <td>135.10</td>
      <td>1297.0</td>
      <td>0.10030</td>
      <td>0.13280</td>
      <td>0.19800</td>
      <td>0.10430</td>
      <td>0.1809</td>
      <td>0.05883</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>564</th>
      <td>21.56</td>
      <td>22.39</td>
      <td>142.00</td>
      <td>1479.0</td>
      <td>0.11100</td>
      <td>0.11590</td>
      <td>0.24390</td>
      <td>0.13890</td>
      <td>0.1726</td>
      <td>0.05623</td>
      <td>0</td>
    </tr>
    <tr>
      <th>565</th>
      <td>20.13</td>
      <td>28.25</td>
      <td>131.20</td>
      <td>1261.0</td>
      <td>0.09780</td>
      <td>0.10340</td>
      <td>0.14400</td>
      <td>0.09791</td>
      <td>0.1752</td>
      <td>0.05533</td>
      <td>0</td>
    </tr>
    <tr>
      <th>566</th>
      <td>16.60</td>
      <td>28.08</td>
      <td>108.30</td>
      <td>858.1</td>
      <td>0.08455</td>
      <td>0.10230</td>
      <td>0.09251</td>
      <td>0.05302</td>
      <td>0.1590</td>
      <td>0.05648</td>
      <td>0</td>
    </tr>
    <tr>
      <th>567</th>
      <td>20.60</td>
      <td>29.33</td>
      <td>140.10</td>
      <td>1265.0</td>
      <td>0.11780</td>
      <td>0.27700</td>
      <td>0.35140</td>
      <td>0.15200</td>
      <td>0.2397</td>
      <td>0.07016</td>
      <td>0</td>
    </tr>
    <tr>
      <th>568</th>
      <td>7.76</td>
      <td>24.54</td>
      <td>47.92</td>
      <td>181.0</td>
      <td>0.05263</td>
      <td>0.04362</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>0.1587</td>
      <td>0.05884</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>569 rows Ã— 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-790ce0e7-6241-4622-82f9-34451b6fb4f8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-790ce0e7-6241-4622-82f9-34451b6fb4f8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-790ce0e7-6241-4622-82f9-34451b6fb4f8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ef8597e1-afde-4f0c-8d35-8126d76586c2">
  <button class="colab-df-quickchart" onclick="quickchart('df-ef8597e1-afde-4f0c-8d35-8126d76586c2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ef8597e1-afde-4f0c-8d35-8126d76586c2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#using stripplot function from seaborn</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">new_dataset</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span><span class="p">,</span> <span class="n">diag_kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xv_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">values</span>
<span class="n">xv_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">values</span>
<span class="n">shape_xv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">xv_train</span><span class="p">)</span>
<span class="n">yv_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span>
<span class="n">yv_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">xv_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">xv_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">yv_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">yv_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(426, 10)
(143, 10)
(426,)
(143,)
</pre></div>
</div>
</div>
</div>
<section id="building-the-model">
<h3>Building the model<a class="headerlink" href="#building-the-model" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">model_1</span><span class="p">:</span>

    <span class="n">Î±</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Î±&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">Î²</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Î²&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape_xv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">Î¼</span> <span class="o">=</span> <span class="n">Î±</span> <span class="o">+</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">xv_train</span><span class="p">,</span> <span class="n">Î²</span><span class="p">)</span>


    <span class="n">Î¸</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Deterministic</span><span class="p">(</span><span class="s1">&#39;Î¸&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Î¼</span><span class="p">)))</span>
    <span class="c1">#bd = pm.Deterministic(&#39;bd&#39;, -Î±/Î²[1] - Î²[0]/Î²[1] * x_1[:,0])</span>


    <span class="n">yl</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Bernoulli</span><span class="p">(</span><span class="s1">&#39;yl&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">Î¸</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">yv_train</span><span class="p">)</span>

    <span class="n">trace_1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">target_accept</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
<div>
  <progress value='3000' class='' max='3000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [3000/3000 05:14&lt;00:00 Sampling chain 0, 0 divergences]
</div>
</div><div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
<div>
  <progress value='3000' class='' max='3000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [3000/3000 05:16&lt;00:00 Sampling chain 1, 0 divergences]
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;Î±&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;Î±&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î²&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;Î²&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î¸&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;Î¸&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
<img alt="_images/Sol_assignment2_22_1.png" src="_images/Sol_assignment2_22_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ed97e6e2-6b68-4f0d-a72a-4d855fb190f0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Î±</th>
      <td>3.265</td>
      <td>4.098</td>
      <td>-3.902</td>
      <td>11.622</td>
      <td>0.122</td>
      <td>0.089</td>
      <td>1128.0</td>
      <td>1242.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Î²[0]</th>
      <td>5.155</td>
      <td>1.751</td>
      <td>1.874</td>
      <td>8.353</td>
      <td>0.058</td>
      <td>0.041</td>
      <td>931.0</td>
      <td>1165.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Î²[1]</th>
      <td>-0.258</td>
      <td>0.053</td>
      <td>-0.359</td>
      <td>-0.164</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>2018.0</td>
      <td>1436.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Î²[2]</th>
      <td>-0.527</td>
      <td>0.242</td>
      <td>-0.977</td>
      <td>-0.082</td>
      <td>0.008</td>
      <td>0.005</td>
      <td>1052.0</td>
      <td>1034.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Î²[3]</th>
      <td>-0.030</td>
      <td>0.008</td>
      <td>-0.044</td>
      <td>-0.016</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1170.0</td>
      <td>1115.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Î¸[421]</th>
      <td>0.996</td>
      <td>0.003</td>
      <td>0.992</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>2022.0</td>
      <td>1260.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Î¸[422]</th>
      <td>0.990</td>
      <td>0.006</td>
      <td>0.980</td>
      <td>0.998</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1886.0</td>
      <td>1418.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Î¸[423]</th>
      <td>0.896</td>
      <td>0.042</td>
      <td>0.820</td>
      <td>0.969</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>1886.0</td>
      <td>1643.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Î¸[424]</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.001</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1424.0</td>
      <td>1466.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Î¸[425]</th>
      <td>0.988</td>
      <td>0.006</td>
      <td>0.976</td>
      <td>0.997</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>2123.0</td>
      <td>1659.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>437 rows Ã— 9 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ed97e6e2-6b68-4f0d-a72a-4d855fb190f0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ed97e6e2-6b68-4f0d-a72a-4d855fb190f0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ed97e6e2-6b68-4f0d-a72a-4d855fb190f0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-88e795ce-ae6b-467a-b08b-9e0f7ef88b86">
  <button class="colab-df-quickchart" onclick="quickchart('df-88e795ce-ae6b-467a-b08b-9e0f7ef88b86')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-88e795ce-ae6b-467a-b08b-9e0f7ef88b86 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">trace_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.10/dist-packages/arviz/plots/plot_utils.py:271: UserWarning: rcParams[&#39;plot.max_subplots&#39;] (40) is smaller than the number of variables to plot (437) in plot_posterior, generating only 40 plots
  warnings.warn(
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;Î±&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;Î²\n0&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î²\n1&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î²\n2&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î²\n3&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î²\n4&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î²\n5&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î²\n6&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î²\n7&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î²\n8&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î²\n9&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n0&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î¸\n1&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n2&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n3&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n4&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î¸\n5&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n6&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n7&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n8&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î¸\n9&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n10&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n11&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n12&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î¸\n13&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n14&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n15&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n16&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î¸\n17&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n18&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n19&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n20&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î¸\n21&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n22&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n23&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n24&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Î¸\n25&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n26&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n27&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;Î¸\n28&#39;}&gt;]], dtype=object)
</pre></div>
</div>
<img alt="_images/Sol_assignment2_24_2.png" src="_images/Sol_assignment2_24_2.png" />
</div>
</div>
</section>
<section id="predictions-on-test-data">
<h3>Predictions on test data<a class="headerlink" href="#predictions-on-test-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alpha_chain</span> <span class="o">=</span> <span class="n">trace_1</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;Î±&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">beta_chain</span>  <span class="o">=</span> <span class="n">trace_1</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;Î²&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">alpha_chain</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">beta_chain</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1000,) (1000, 10)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">xv_test</span><span class="p">,</span> <span class="n">beta_chain</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">alpha_chain</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">logit</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(143, 1000)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">probabilities</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">logit</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">probabilities</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(143, 1000)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">yv_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(143,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Average probabilities for prediction</span>
<span class="n">mean_probabilities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Class assignment (you might adjust the threshold if needed, default is 0.5)</span>
<span class="n">class_assignments</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean_probabilities</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Uncertainty estimation</span>
<span class="n">lower_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">upper_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TEST DATA: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xv_test</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;class, probabilities, ranges(94%HDI): &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">yv_test</span><span class="p">,</span> <span class="n">class_assignments</span><span class="p">,</span> <span class="n">mean_probabilities</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span><span class="n">upper_bound</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ground-truth: </span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">, class: </span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s2">, mean prob. </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, 94% HDI: [</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=======================================
TEST DATA: 
 [[1.125e+01 9.742e+00 1.754e+01 ... 2.055e+01 1.287e+01 2.321e+01]
 [1.478e+01 1.567e+01 1.932e+01 ... 2.086e+01 1.954e+01 2.697e+01]
 [7.138e+01 6.150e+01 1.151e+02 ... 1.378e+02 8.267e+01 1.535e+02]
 ...
 [2.941e-03 1.407e-02 7.488e-02 ... 1.322e-01 2.090e-02 1.237e-01]
 [1.773e-01 2.081e-01 1.506e-01 ... 2.127e-01 1.861e-01 1.909e-01]
 [6.081e-02 6.312e-02 5.491e-02 ... 6.251e-02 6.347e-02 6.309e-02]]
=======================================

class, probabilities, ranges(94%HDI): 
ground-truth: 1, class: 1, mean prob. 0.9979, 94% HDI: [0.9954,0.9992]
ground-truth: 1, class: 1, mean prob. 0.9974, 94% HDI: [0.9937,0.9992]
ground-truth: 0, class: 0, mean prob. 0.0271, 94% HDI: [0.0095,0.0606]
ground-truth: 1, class: 1, mean prob. 0.9844, 94% HDI: [0.9722,0.9926]
ground-truth: 0, class: 0, mean prob. 0.0024, 94% HDI: [0.0004,0.0075]
ground-truth: 1, class: 1, mean prob. 0.6446, 94% HDI: [0.5177,0.7538]
ground-truth: 1, class: 1, mean prob. 0.9575, 94% HDI: [0.9341,0.9746]
ground-truth: 0, class: 1, mean prob. 0.9876, 94% HDI: [0.9773,0.9938]
ground-truth: 1, class: 1, mean prob. 0.9467, 94% HDI: [0.9040,0.9756]
ground-truth: 1, class: 1, mean prob. 0.9081, 94% HDI: [0.8591,0.9464]
ground-truth: 1, class: 1, mean prob. 0.9877, 94% HDI: [0.9760,0.9953]
ground-truth: 0, class: 0, mean prob. 0.0116, 94% HDI: [0.0039,0.0260]
ground-truth: 0, class: 0, mean prob. 0.0983, 94% HDI: [0.0383,0.1964]
ground-truth: 1, class: 1, mean prob. 0.9915, 94% HDI: [0.9840,0.9962]
ground-truth: 0, class: 0, mean prob. 0.0060, 94% HDI: [0.0011,0.0180]
ground-truth: 1, class: 1, mean prob. 0.9626, 94% HDI: [0.9408,0.9781]
ground-truth: 1, class: 1, mean prob. 0.9908, 94% HDI: [0.9833,0.9957]
ground-truth: 1, class: 1, mean prob. 0.9876, 94% HDI: [0.9791,0.9937]
ground-truth: 1, class: 1, mean prob. 0.9717, 94% HDI: [0.9510,0.9848]
ground-truth: 1, class: 1, mean prob. 0.9860, 94% HDI: [0.9751,0.9930]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 1, mean prob. 0.9401, 94% HDI: [0.9092,0.9642]
ground-truth: 1, class: 1, mean prob. 0.9714, 94% HDI: [0.9509,0.9853]
ground-truth: 1, class: 1, mean prob. 0.9655, 94% HDI: [0.9274,0.9881]
ground-truth: 1, class: 1, mean prob. 0.9862, 94% HDI: [0.9748,0.9940]
ground-truth: 0, class: 0, mean prob. 0.0251, 94% HDI: [0.0099,0.0493]
ground-truth: 0, class: 0, mean prob. 0.0583, 94% HDI: [0.0290,0.1002]
ground-truth: 1, class: 1, mean prob. 0.9923, 94% HDI: [0.9856,0.9963]
ground-truth: 0, class: 0, mean prob. 0.1865, 94% HDI: [0.1056,0.2782]
ground-truth: 1, class: 1, mean prob. 0.9979, 94% HDI: [0.9950,0.9993]
ground-truth: 0, class: 1, mean prob. 0.7574, 94% HDI: [0.6417,0.8530]
ground-truth: 1, class: 1, mean prob. 0.9951, 94% HDI: [0.9903,0.9980]
ground-truth: 1, class: 1, mean prob. 0.9559, 94% HDI: [0.9261,0.9765]
ground-truth: 1, class: 1, mean prob. 0.9906, 94% HDI: [0.9829,0.9954]
ground-truth: 0, class: 0, mean prob. 0.3801, 94% HDI: [0.2711,0.5056]
ground-truth: 1, class: 1, mean prob. 0.9963, 94% HDI: [0.9921,0.9986]
ground-truth: 1, class: 1, mean prob. 0.9557, 94% HDI: [0.9238,0.9773]
ground-truth: 1, class: 1, mean prob. 0.9856, 94% HDI: [0.9757,0.9924]
ground-truth: 1, class: 1, mean prob. 0.9851, 94% HDI: [0.9737,0.9926]
ground-truth: 0, class: 0, mean prob. 0.0003, 94% HDI: [0.0000,0.0012]
ground-truth: 0, class: 1, mean prob. 0.5834, 94% HDI: [0.4833,0.6747]
ground-truth: 1, class: 1, mean prob. 0.9908, 94% HDI: [0.9807,0.9965]
ground-truth: 0, class: 1, mean prob. 0.5778, 94% HDI: [0.4193,0.7278]
ground-truth: 1, class: 1, mean prob. 0.9222, 94% HDI: [0.8904,0.9480]
ground-truth: 0, class: 0, mean prob. 0.1962, 94% HDI: [0.1210,0.2904]
ground-truth: 1, class: 1, mean prob. 0.9172, 94% HDI: [0.8597,0.9581]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0824, 94% HDI: [0.0418,0.1357]
ground-truth: 0, class: 0, mean prob. 0.4835, 94% HDI: [0.3946,0.5687]
ground-truth: 0, class: 0, mean prob. 0.3333, 94% HDI: [0.2363,0.4422]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 1, class: 1, mean prob. 0.7865, 94% HDI: [0.7080,0.8517]
ground-truth: 1, class: 1, mean prob. 0.9867, 94% HDI: [0.9769,0.9935]
ground-truth: 1, class: 1, mean prob. 0.9758, 94% HDI: [0.9585,0.9877]
ground-truth: 0, class: 0, mean prob. 0.0236, 94% HDI: [0.0094,0.0467]
ground-truth: 1, class: 1, mean prob. 0.9850, 94% HDI: [0.9740,0.9925]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0002]
ground-truth: 1, class: 1, mean prob. 0.8380, 94% HDI: [0.7810,0.8861]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 1, class: 1, mean prob. 0.9906, 94% HDI: [0.9830,0.9956]
ground-truth: 1, class: 1, mean prob. 0.9836, 94% HDI: [0.9712,0.9915]
ground-truth: 1, class: 1, mean prob. 0.9993, 94% HDI: [0.9982,0.9998]
ground-truth: 1, class: 1, mean prob. 0.9648, 94% HDI: [0.9436,0.9804]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9544, 94% HDI: [0.9072,0.9829]
ground-truth: 1, class: 1, mean prob. 0.9508, 94% HDI: [0.9127,0.9778]
ground-truth: 1, class: 1, mean prob. 0.9192, 94% HDI: [0.8261,0.9738]
ground-truth: 0, class: 0, mean prob. 0.3319, 94% HDI: [0.2357,0.4325]
ground-truth: 1, class: 1, mean prob. 0.9937, 94% HDI: [0.9879,0.9973]
ground-truth: 1, class: 1, mean prob. 0.9953, 94% HDI: [0.9904,0.9981]
ground-truth: 0, class: 1, mean prob. 0.6508, 94% HDI: [0.5463,0.7520]
ground-truth: 1, class: 1, mean prob. 0.9322, 94% HDI: [0.8904,0.9622]
ground-truth: 0, class: 0, mean prob. 0.4666, 94% HDI: [0.3525,0.5801]
ground-truth: 1, class: 1, mean prob. 0.9950, 94% HDI: [0.9887,0.9983]
ground-truth: 1, class: 1, mean prob. 0.9206, 94% HDI: [0.8853,0.9490]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0022, 94% HDI: [0.0006,0.0059]
ground-truth: 0, class: 0, mean prob. 0.0253, 94% HDI: [0.0063,0.0618]
ground-truth: 1, class: 1, mean prob. 0.9229, 94% HDI: [0.8825,0.9532]
ground-truth: 0, class: 0, mean prob. 0.0627, 94% HDI: [0.0291,0.1111]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0002]
ground-truth: 1, class: 1, mean prob. 0.9992, 94% HDI: [0.9981,0.9998]
ground-truth: 1, class: 1, mean prob. 0.9966, 94% HDI: [0.9923,0.9988]
ground-truth: 1, class: 1, mean prob. 0.9916, 94% HDI: [0.9836,0.9965]
ground-truth: 0, class: 0, mean prob. 0.0195, 94% HDI: [0.0066,0.0430]
ground-truth: 1, class: 1, mean prob. 0.9960, 94% HDI: [0.9923,0.9984]
ground-truth: 0, class: 0, mean prob. 0.1186, 94% HDI: [0.0697,0.1831]
ground-truth: 1, class: 1, mean prob. 0.9442, 94% HDI: [0.9115,0.9661]
ground-truth: 0, class: 1, mean prob. 0.6332, 94% HDI: [0.5319,0.7185]
ground-truth: 1, class: 1, mean prob. 0.9771, 94% HDI: [0.9640,0.9872]
ground-truth: 1, class: 1, mean prob. 0.9924, 94% HDI: [0.9860,0.9965]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9857, 94% HDI: [0.9737,0.9934]
ground-truth: 1, class: 1, mean prob. 0.9560, 94% HDI: [0.9296,0.9756]
ground-truth: 1, class: 1, mean prob. 0.9570, 94% HDI: [0.9348,0.9736]
ground-truth: 1, class: 1, mean prob. 0.9043, 94% HDI: [0.8429,0.9484]
ground-truth: 1, class: 1, mean prob. 0.9904, 94% HDI: [0.9807,0.9959]
ground-truth: 1, class: 1, mean prob. 0.9887, 94% HDI: [0.9785,0.9955]
ground-truth: 1, class: 1, mean prob. 0.9512, 94% HDI: [0.9207,0.9733]
ground-truth: 1, class: 1, mean prob. 0.9988, 94% HDI: [0.9968,0.9997]
ground-truth: 1, class: 1, mean prob. 0.9246, 94% HDI: [0.8848,0.9543]
ground-truth: 1, class: 1, mean prob. 0.8805, 94% HDI: [0.8267,0.9238]
ground-truth: 1, class: 1, mean prob. 0.9770, 94% HDI: [0.9593,0.9888]
ground-truth: 1, class: 1, mean prob. 0.9991, 94% HDI: [0.9974,0.9998]
ground-truth: 1, class: 1, mean prob. 0.9938, 94% HDI: [0.9880,0.9973]
ground-truth: 1, class: 1, mean prob. 0.9803, 94% HDI: [0.9654,0.9897]
ground-truth: 1, class: 1, mean prob. 0.9944, 94% HDI: [0.9862,0.9984]
ground-truth: 1, class: 1, mean prob. 0.9974, 94% HDI: [0.9941,0.9991]
ground-truth: 1, class: 1, mean prob. 0.9982, 94% HDI: [0.9957,0.9994]
ground-truth: 1, class: 1, mean prob. 0.9858, 94% HDI: [0.9752,0.9933]
ground-truth: 1, class: 1, mean prob. 0.9905, 94% HDI: [0.9831,0.9953]
ground-truth: 0, class: 0, mean prob. 0.0015, 94% HDI: [0.0003,0.0043]
ground-truth: 0, class: 0, mean prob. 0.0945, 94% HDI: [0.0389,0.1848]
ground-truth: 0, class: 0, mean prob. 0.0028, 94% HDI: [0.0005,0.0086]
ground-truth: 1, class: 1, mean prob. 0.9904, 94% HDI: [0.9822,0.9956]
ground-truth: 0, class: 0, mean prob. 0.0059, 94% HDI: [0.0017,0.0140]
ground-truth: 1, class: 1, mean prob. 0.9975, 94% HDI: [0.9946,0.9991]
ground-truth: 1, class: 1, mean prob. 0.9140, 94% HDI: [0.8804,0.9430]
ground-truth: 1, class: 0, mean prob. 0.4691, 94% HDI: [0.3239,0.6180]
ground-truth: 1, class: 1, mean prob. 0.9934, 94% HDI: [0.9868,0.9973]
ground-truth: 1, class: 1, mean prob. 0.9929, 94% HDI: [0.9868,0.9969]
ground-truth: 1, class: 1, mean prob. 0.9807, 94% HDI: [0.9661,0.9900]
ground-truth: 0, class: 0, mean prob. 0.0048, 94% HDI: [0.0011,0.0123]
ground-truth: 1, class: 1, mean prob. 0.9732, 94% HDI: [0.9515,0.9871]
ground-truth: 0, class: 0, mean prob. 0.2830, 94% HDI: [0.1459,0.4572]
ground-truth: 0, class: 0, mean prob. 0.0769, 94% HDI: [0.0316,0.1421]
ground-truth: 1, class: 1, mean prob. 0.9856, 94% HDI: [0.9751,0.9927]
ground-truth: 1, class: 1, mean prob. 0.7376, 94% HDI: [0.5955,0.8569]
ground-truth: 0, class: 0, mean prob. 0.0040, 94% HDI: [0.0010,0.0107]
ground-truth: 1, class: 1, mean prob. 0.9973, 94% HDI: [0.9941,0.9991]
ground-truth: 1, class: 1, mean prob. 0.9954, 94% HDI: [0.9905,0.9983]
ground-truth: 0, class: 1, mean prob. 0.5708, 94% HDI: [0.4547,0.6788]
ground-truth: 0, class: 0, mean prob. 0.0501, 94% HDI: [0.0252,0.0853]
ground-truth: 1, class: 1, mean prob. 0.9972, 94% HDI: [0.9939,0.9990]
ground-truth: 1, class: 1, mean prob. 0.9636, 94% HDI: [0.9354,0.9827]
ground-truth: 1, class: 1, mean prob. 0.9882, 94% HDI: [0.9787,0.9943]
ground-truth: 0, class: 0, mean prob. 0.0071, 94% HDI: [0.0023,0.0164]
ground-truth: 0, class: 0, mean prob. 0.0013, 94% HDI: [0.0002,0.0040]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9660, 94% HDI: [0.9475,0.9800]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
=======================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">yv_test</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">class_assignments</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">yv_test</span><span class="p">),</span><span class="nb">type</span><span class="p">(</span><span class="n">class_assignments</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(143,) (143,)
&lt;class &#39;numpy.ndarray&#39;&gt; &lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (1.2.2)
Requirement already satisfied: numpy&gt;=1.17.3 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.25.2)
Requirement already satisfied: scipy&gt;=1.3.2 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.11.4)
Requirement already satisfied: joblib&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (3.3.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="c1"># Calculate Accuracy</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">yv_test</span><span class="p">,</span> <span class="n">class_assignments</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate Confusion Matrix</span>
<span class="n">conf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">yv_test</span><span class="p">,</span> <span class="n">class_assignments</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="si">{</span><span class="n">conf_matrix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.9370629370629371
Confusion Matrix:
[[46  8]
 [ 1 88]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="analysis-on-training-data">
<h3>Analysis on Training Data<a class="headerlink" href="#analysis-on-training-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logit_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">xv_train</span><span class="p">,</span> <span class="n">beta_chain</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">alpha_chain</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">logit</span><span class="p">))</span>

<span class="n">probabilities_train</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">logit_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">probabilities_train</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(143, 1000)
(426, 1000)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Average probabilities for prediction</span>
<span class="n">mean_probabilities_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">probabilities_train</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Class assignment (you might adjust the threshold if needed, default is 0.5)</span>
<span class="n">class_assignments_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean_probabilities_train</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Uncertainty estimation</span>
<span class="n">lower_bound_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">probabilities_train</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">upper_bound_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">probabilities_train</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAINING DATA: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xv_train</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;class, probabilities, ranges(94%HDI): &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">yv_train</span><span class="p">,</span> <span class="n">class_assignments_train</span><span class="p">,</span> <span class="n">mean_probabilities_train</span><span class="p">,</span> <span class="n">lower_bound_train</span><span class="p">,</span> <span class="n">upper_bound_train</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ground-truth: </span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">, class: </span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s2">, mean prob. </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, 94% HDI: [</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=======================================
TRAINING DATA: 
 [[1.154e+01 2.031e+01 1.136e+01 ... 1.205e+01 2.044e+01 1.174e+01]
 [1.444e+01 2.706e+01 1.757e+01 ... 2.272e+01 2.178e+01 1.469e+01]
 [7.465e+01 1.329e+02 7.249e+01 ... 7.875e+01 1.338e+02 7.631e+01]
 ...
 [2.594e-02 9.333e-02 2.100e-02 ... 2.978e-02 7.785e-02 2.639e-02]
 [1.818e-01 1.814e-01 1.601e-01 ... 1.203e-01 1.618e-01 1.499e-01]
 [6.782e-02 5.572e-02 5.913e-02 ... 6.659e-02 5.557e-02 6.758e-02]]
=======================================

class, probabilities, ranges(94%HDI): 
ground-truth: 1, class: 1, mean prob. 0.9908, 94% HDI: [0.9824,0.9958]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 1, class: 1, mean prob. 0.9927, 94% HDI: [0.9865,0.9966]
ground-truth: 0, class: 0, mean prob. 0.1042, 94% HDI: [0.0483,0.1843]
ground-truth: 0, class: 0, mean prob. 0.0037, 94% HDI: [0.0008,0.0109]
ground-truth: 1, class: 1, mean prob. 0.7960, 94% HDI: [0.6794,0.8874]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9966, 94% HDI: [0.9925,0.9988]
ground-truth: 0, class: 1, mean prob. 0.5376, 94% HDI: [0.3663,0.6984]
ground-truth: 1, class: 1, mean prob. 0.9934, 94% HDI: [0.9872,0.9972]
ground-truth: 1, class: 1, mean prob. 0.9943, 94% HDI: [0.9867,0.9983]
ground-truth: 0, class: 0, mean prob. 0.3296, 94% HDI: [0.2068,0.4603]
ground-truth: 1, class: 1, mean prob. 0.9932, 94% HDI: [0.9839,0.9980]
ground-truth: 0, class: 0, mean prob. 0.0503, 94% HDI: [0.0176,0.1015]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.2300, 94% HDI: [0.1556,0.3150]
ground-truth: 1, class: 1, mean prob. 0.8637, 94% HDI: [0.8154,0.9050]
ground-truth: 1, class: 1, mean prob. 0.9132, 94% HDI: [0.8660,0.9500]
ground-truth: 1, class: 1, mean prob. 0.9040, 94% HDI: [0.8497,0.9440]
ground-truth: 0, class: 0, mean prob. 0.1681, 94% HDI: [0.0792,0.3039]
ground-truth: 1, class: 0, mean prob. 0.2894, 94% HDI: [0.1584,0.4259]
ground-truth: 1, class: 1, mean prob. 0.9931, 94% HDI: [0.9864,0.9970]
ground-truth: 1, class: 1, mean prob. 0.9743, 94% HDI: [0.9516,0.9885]
ground-truth: 1, class: 1, mean prob. 0.9970, 94% HDI: [0.9892,0.9996]
ground-truth: 0, class: 0, mean prob. 0.0170, 94% HDI: [0.0064,0.0346]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0002]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0002]
ground-truth: 0, class: 1, mean prob. 0.8329, 94% HDI: [0.7451,0.9026]
ground-truth: 1, class: 1, mean prob. 0.8942, 94% HDI: [0.8290,0.9394]
ground-truth: 1, class: 1, mean prob. 0.9919, 94% HDI: [0.9834,0.9967]
ground-truth: 0, class: 0, mean prob. 0.0274, 94% HDI: [0.0093,0.0574]
ground-truth: 1, class: 1, mean prob. 0.9804, 94% HDI: [0.9668,0.9902]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0004]
ground-truth: 1, class: 1, mean prob. 0.8561, 94% HDI: [0.7595,0.9217]
ground-truth: 1, class: 1, mean prob. 0.8610, 94% HDI: [0.7909,0.9139]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0004]
ground-truth: 1, class: 1, mean prob. 0.9484, 94% HDI: [0.9117,0.9729]
ground-truth: 1, class: 1, mean prob. 0.9900, 94% HDI: [0.9784,0.9963]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9980, 94% HDI: [0.9954,0.9993]
ground-truth: 1, class: 1, mean prob. 0.9869, 94% HDI: [0.9772,0.9932]
ground-truth: 0, class: 0, mean prob. 0.0804, 94% HDI: [0.0377,0.1363]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9766, 94% HDI: [0.9614,0.9873]
ground-truth: 0, class: 0, mean prob. 0.0006, 94% HDI: [0.0001,0.0021]
ground-truth: 0, class: 1, mean prob. 0.5348, 94% HDI: [0.4366,0.6363]
ground-truth: 1, class: 1, mean prob. 0.9893, 94% HDI: [0.9807,0.9948]
ground-truth: 0, class: 0, mean prob. 0.0004, 94% HDI: [0.0000,0.0017]
ground-truth: 1, class: 1, mean prob. 0.9304, 94% HDI: [0.8978,0.9559]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 1, class: 1, mean prob. 0.9909, 94% HDI: [0.9830,0.9956]
ground-truth: 1, class: 1, mean prob. 0.8778, 94% HDI: [0.8179,0.9238]
ground-truth: 1, class: 1, mean prob. 0.9977, 94% HDI: [0.9948,0.9992]
ground-truth: 1, class: 1, mean prob. 0.9426, 94% HDI: [0.9163,0.9636]
ground-truth: 1, class: 1, mean prob. 0.9925, 94% HDI: [0.9850,0.9969]
ground-truth: 1, class: 1, mean prob. 0.5795, 94% HDI: [0.4750,0.6770]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0004]
ground-truth: 0, class: 0, mean prob. 0.0013, 94% HDI: [0.0002,0.0041]
ground-truth: 1, class: 1, mean prob. 0.9837, 94% HDI: [0.9721,0.9915]
ground-truth: 1, class: 1, mean prob. 0.6086, 94% HDI: [0.4702,0.7396]
ground-truth: 0, class: 0, mean prob. 0.0092, 94% HDI: [0.0027,0.0235]
ground-truth: 1, class: 0, mean prob. 0.4178, 94% HDI: [0.1866,0.6596]
ground-truth: 1, class: 1, mean prob. 0.9920, 94% HDI: [0.9856,0.9963]
ground-truth: 1, class: 1, mean prob. 0.9780, 94% HDI: [0.9576,0.9908]
ground-truth: 1, class: 1, mean prob. 0.9378, 94% HDI: [0.8897,0.9682]
ground-truth: 0, class: 0, mean prob. 0.0014, 94% HDI: [0.0002,0.0052]
ground-truth: 0, class: 1, mean prob. 0.7745, 94% HDI: [0.6815,0.8527]
ground-truth: 1, class: 1, mean prob. 0.9925, 94% HDI: [0.9865,0.9965]
ground-truth: 0, class: 1, mean prob. 0.8075, 94% HDI: [0.6847,0.8977]
ground-truth: 1, class: 1, mean prob. 0.9429, 94% HDI: [0.9042,0.9688]
ground-truth: 1, class: 1, mean prob. 0.9985, 94% HDI: [0.9963,0.9996]
ground-truth: 1, class: 1, mean prob. 0.9875, 94% HDI: [0.9742,0.9952]
ground-truth: 1, class: 1, mean prob. 0.7618, 94% HDI: [0.6868,0.8226]
ground-truth: 0, class: 0, mean prob. 0.0077, 94% HDI: [0.0024,0.0178]
ground-truth: 1, class: 1, mean prob. 0.9840, 94% HDI: [0.9735,0.9915]
ground-truth: 1, class: 1, mean prob. 0.9658, 94% HDI: [0.9472,0.9794]
ground-truth: 1, class: 1, mean prob. 0.9963, 94% HDI: [0.9924,0.9985]
ground-truth: 0, class: 0, mean prob. 0.0019, 94% HDI: [0.0003,0.0064]
ground-truth: 1, class: 1, mean prob. 0.9715, 94% HDI: [0.9465,0.9867]
ground-truth: 1, class: 1, mean prob. 0.9798, 94% HDI: [0.9637,0.9904]
ground-truth: 0, class: 0, mean prob. 0.0072, 94% HDI: [0.0015,0.0188]
ground-truth: 1, class: 1, mean prob. 0.9936, 94% HDI: [0.9864,0.9977]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0004]
ground-truth: 1, class: 1, mean prob. 0.9416, 94% HDI: [0.9125,0.9645]
ground-truth: 1, class: 1, mean prob. 0.7024, 94% HDI: [0.5463,0.8351]
ground-truth: 1, class: 1, mean prob. 0.9816, 94% HDI: [0.9671,0.9914]
ground-truth: 0, class: 0, mean prob. 0.2069, 94% HDI: [0.1354,0.2914]
ground-truth: 1, class: 1, mean prob. 0.9982, 94% HDI: [0.9957,0.9994]
ground-truth: 0, class: 0, mean prob. 0.1395, 94% HDI: [0.0545,0.2551]
ground-truth: 1, class: 1, mean prob. 0.9511, 94% HDI: [0.9152,0.9760]
ground-truth: 1, class: 1, mean prob. 0.9968, 94% HDI: [0.9933,0.9988]
ground-truth: 1, class: 1, mean prob. 0.8854, 94% HDI: [0.8365,0.9257]
ground-truth: 1, class: 1, mean prob. 0.9956, 94% HDI: [0.9914,0.9982]
ground-truth: 1, class: 1, mean prob. 0.9925, 94% HDI: [0.9857,0.9968]
ground-truth: 1, class: 1, mean prob. 0.9595, 94% HDI: [0.9311,0.9793]
ground-truth: 1, class: 1, mean prob. 0.6976, 94% HDI: [0.5536,0.8192]
ground-truth: 0, class: 0, mean prob. 0.0864, 94% HDI: [0.0417,0.1457]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0004]
ground-truth: 1, class: 1, mean prob. 0.9244, 94% HDI: [0.8824,0.9574]
ground-truth: 1, class: 1, mean prob. 0.9970, 94% HDI: [0.9932,0.9990]
ground-truth: 1, class: 1, mean prob. 0.9822, 94% HDI: [0.9674,0.9917]
ground-truth: 1, class: 1, mean prob. 0.9535, 94% HDI: [0.9292,0.9733]
ground-truth: 1, class: 1, mean prob. 0.8492, 94% HDI: [0.7573,0.9210]
ground-truth: 0, class: 0, mean prob. 0.0041, 94% HDI: [0.0010,0.0107]
ground-truth: 1, class: 0, mean prob. 0.1323, 94% HDI: [0.0603,0.2306]
ground-truth: 1, class: 1, mean prob. 0.7236, 94% HDI: [0.5854,0.8412]
ground-truth: 1, class: 1, mean prob. 0.9620, 94% HDI: [0.9399,0.9783]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9970, 94% HDI: [0.9936,0.9989]
ground-truth: 1, class: 1, mean prob. 0.9869, 94% HDI: [0.9755,0.9940]
ground-truth: 1, class: 1, mean prob. 0.9907, 94% HDI: [0.9825,0.9958]
ground-truth: 1, class: 1, mean prob. 0.9790, 94% HDI: [0.9645,0.9887]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0052, 94% HDI: [0.0012,0.0151]
ground-truth: 1, class: 1, mean prob. 0.9834, 94% HDI: [0.9657,0.9935]
ground-truth: 0, class: 1, mean prob. 0.7498, 94% HDI: [0.6484,0.8354]
ground-truth: 0, class: 0, mean prob. 0.0154, 94% HDI: [0.0028,0.0440]
ground-truth: 1, class: 1, mean prob. 0.8026, 94% HDI: [0.6419,0.9156]
ground-truth: 1, class: 1, mean prob. 0.9315, 94% HDI: [0.8984,0.9580]
ground-truth: 1, class: 1, mean prob. 0.8399, 94% HDI: [0.7790,0.8946]
ground-truth: 1, class: 1, mean prob. 0.9873, 94% HDI: [0.9764,0.9943]
ground-truth: 0, class: 0, mean prob. 0.0617, 94% HDI: [0.0306,0.1059]
ground-truth: 1, class: 1, mean prob. 0.5250, 94% HDI: [0.3751,0.6701]
ground-truth: 1, class: 0, mean prob. 0.3167, 94% HDI: [0.1832,0.4636]
ground-truth: 1, class: 0, mean prob. 0.4832, 94% HDI: [0.3009,0.6731]
ground-truth: 1, class: 1, mean prob. 0.9100, 94% HDI: [0.8608,0.9471]
ground-truth: 1, class: 1, mean prob. 0.9555, 94% HDI: [0.9298,0.9755]
ground-truth: 1, class: 1, mean prob. 0.9842, 94% HDI: [0.9723,0.9922]
ground-truth: 0, class: 1, mean prob. 0.6390, 94% HDI: [0.5047,0.7623]
ground-truth: 1, class: 1, mean prob. 0.9842, 94% HDI: [0.9709,0.9928]
ground-truth: 1, class: 1, mean prob. 0.5798, 94% HDI: [0.4790,0.6856]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9968, 94% HDI: [0.9931,0.9988]
ground-truth: 1, class: 1, mean prob. 0.9981, 94% HDI: [0.9961,0.9993]
ground-truth: 1, class: 1, mean prob. 0.9930, 94% HDI: [0.9862,0.9970]
ground-truth: 1, class: 1, mean prob. 0.9987, 94% HDI: [0.9967,0.9996]
ground-truth: 1, class: 1, mean prob. 0.9246, 94% HDI: [0.8868,0.9558]
ground-truth: 0, class: 0, mean prob. 0.0010, 94% HDI: [0.0002,0.0030]
ground-truth: 1, class: 0, mean prob. 0.4639, 94% HDI: [0.2895,0.6467]
ground-truth: 1, class: 1, mean prob. 0.9262, 94% HDI: [0.8925,0.9529]
ground-truth: 1, class: 1, mean prob. 0.9483, 94% HDI: [0.9025,0.9762]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9678, 94% HDI: [0.9282,0.9894]
ground-truth: 1, class: 1, mean prob. 0.9652, 94% HDI: [0.9402,0.9812]
ground-truth: 0, class: 0, mean prob. 0.0699, 94% HDI: [0.0280,0.1414]
ground-truth: 1, class: 1, mean prob. 0.7172, 94% HDI: [0.5904,0.8292]
ground-truth: 1, class: 1, mean prob. 0.9748, 94% HDI: [0.9411,0.9917]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 1, class: 1, mean prob. 0.6932, 94% HDI: [0.6113,0.7666]
ground-truth: 0, class: 0, mean prob. 0.0018, 94% HDI: [0.0004,0.0050]
ground-truth: 1, class: 1, mean prob. 0.9848, 94% HDI: [0.9725,0.9929]
ground-truth: 1, class: 1, mean prob. 0.9978, 94% HDI: [0.9949,0.9992]
ground-truth: 1, class: 1, mean prob. 0.7199, 94% HDI: [0.5944,0.8274]
ground-truth: 1, class: 1, mean prob. 0.9778, 94% HDI: [0.9625,0.9885]
ground-truth: 1, class: 1, mean prob. 0.9702, 94% HDI: [0.9525,0.9835]
ground-truth: 1, class: 1, mean prob. 0.9699, 94% HDI: [0.9538,0.9824]
ground-truth: 0, class: 0, mean prob. 0.0014, 94% HDI: [0.0003,0.0037]
ground-truth: 0, class: 0, mean prob. 0.0044, 94% HDI: [0.0011,0.0114]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0004]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0006]
ground-truth: 0, class: 0, mean prob. 0.0005, 94% HDI: [0.0001,0.0018]
ground-truth: 1, class: 1, mean prob. 0.9324, 94% HDI: [0.8993,0.9588]
ground-truth: 1, class: 1, mean prob. 0.9895, 94% HDI: [0.9803,0.9952]
ground-truth: 0, class: 0, mean prob. 0.0037, 94% HDI: [0.0005,0.0125]
ground-truth: 1, class: 1, mean prob. 0.9713, 94% HDI: [0.9531,0.9848]
ground-truth: 0, class: 1, mean prob. 0.7385, 94% HDI: [0.6548,0.8179]
ground-truth: 1, class: 1, mean prob. 0.6536, 94% HDI: [0.3068,0.9065]
ground-truth: 1, class: 1, mean prob. 0.9977, 94% HDI: [0.9952,0.9991]
ground-truth: 1, class: 1, mean prob. 0.9754, 94% HDI: [0.9566,0.9874]
ground-truth: 1, class: 1, mean prob. 0.9610, 94% HDI: [0.9403,0.9773]
ground-truth: 0, class: 0, mean prob. 0.2150, 94% HDI: [0.1311,0.3164]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0002]
ground-truth: 0, class: 0, mean prob. 0.0066, 94% HDI: [0.0017,0.0166]
ground-truth: 0, class: 0, mean prob. 0.0124, 94% HDI: [0.0035,0.0297]
ground-truth: 1, class: 1, mean prob. 0.9854, 94% HDI: [0.9748,0.9926]
ground-truth: 1, class: 1, mean prob. 0.9825, 94% HDI: [0.9608,0.9942]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0177, 94% HDI: [0.0057,0.0400]
ground-truth: 0, class: 1, mean prob. 0.8187, 94% HDI: [0.7580,0.8689]
ground-truth: 1, class: 1, mean prob. 0.9928, 94% HDI: [0.9862,0.9969]
ground-truth: 1, class: 1, mean prob. 0.7348, 94% HDI: [0.6301,0.8270]
ground-truth: 1, class: 1, mean prob. 0.8151, 94% HDI: [0.6457,0.9307]
ground-truth: 1, class: 1, mean prob. 0.9555, 94% HDI: [0.9304,0.9733]
ground-truth: 0, class: 0, mean prob. 0.0006, 94% HDI: [0.0001,0.0020]
ground-truth: 0, class: 0, mean prob. 0.0004, 94% HDI: [0.0001,0.0015]
ground-truth: 1, class: 1, mean prob. 0.9298, 94% HDI: [0.8882,0.9588]
ground-truth: 1, class: 1, mean prob. 0.9894, 94% HDI: [0.9784,0.9956]
ground-truth: 0, class: 0, mean prob. 0.0873, 94% HDI: [0.0404,0.1546]
ground-truth: 1, class: 1, mean prob. 0.9388, 94% HDI: [0.8953,0.9692]
ground-truth: 0, class: 0, mean prob. 0.4636, 94% HDI: [0.3445,0.5785]
ground-truth: 0, class: 0, mean prob. 0.0135, 94% HDI: [0.0038,0.0325]
ground-truth: 1, class: 1, mean prob. 0.9653, 94% HDI: [0.9460,0.9795]
ground-truth: 1, class: 1, mean prob. 0.9657, 94% HDI: [0.9458,0.9802]
ground-truth: 1, class: 1, mean prob. 0.9672, 94% HDI: [0.9465,0.9823]
ground-truth: 1, class: 1, mean prob. 0.9861, 94% HDI: [0.9742,0.9935]
ground-truth: 1, class: 1, mean prob. 0.9934, 94% HDI: [0.9872,0.9970]
ground-truth: 1, class: 1, mean prob. 0.9928, 94% HDI: [0.9862,0.9967]
ground-truth: 1, class: 1, mean prob. 0.8636, 94% HDI: [0.7777,0.9286]
ground-truth: 1, class: 0, mean prob. 0.4235, 94% HDI: [0.2935,0.5578]
ground-truth: 0, class: 1, mean prob. 0.7137, 94% HDI: [0.6349,0.7876]
ground-truth: 1, class: 1, mean prob. 0.9980, 94% HDI: [0.9949,0.9995]
ground-truth: 1, class: 1, mean prob. 0.9939, 94% HDI: [0.9877,0.9977]
ground-truth: 0, class: 0, mean prob. 0.0048, 94% HDI: [0.0014,0.0114]
ground-truth: 0, class: 0, mean prob. 0.0139, 94% HDI: [0.0043,0.0322]
ground-truth: 1, class: 1, mean prob. 0.9910, 94% HDI: [0.9832,0.9959]
ground-truth: 1, class: 1, mean prob. 0.9793, 94% HDI: [0.9648,0.9895]
ground-truth: 1, class: 1, mean prob. 0.9942, 94% HDI: [0.9884,0.9975]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 1, class: 1, mean prob. 0.9666, 94% HDI: [0.9413,0.9830]
ground-truth: 0, class: 0, mean prob. 0.1121, 94% HDI: [0.0576,0.1857]
ground-truth: 1, class: 1, mean prob. 0.7634, 94% HDI: [0.6858,0.8317]
ground-truth: 1, class: 1, mean prob. 0.8903, 94% HDI: [0.8394,0.9306]
ground-truth: 0, class: 0, mean prob. 0.4042, 94% HDI: [0.2759,0.5379]
ground-truth: 1, class: 1, mean prob. 0.5648, 94% HDI: [0.4453,0.6807]
ground-truth: 0, class: 0, mean prob. 0.0113, 94% HDI: [0.0035,0.0264]
ground-truth: 1, class: 1, mean prob. 0.9340, 94% HDI: [0.9049,0.9576]
ground-truth: 0, class: 0, mean prob. 0.1082, 94% HDI: [0.0465,0.1948]
ground-truth: 1, class: 1, mean prob. 0.9728, 94% HDI: [0.9547,0.9857]
ground-truth: 1, class: 1, mean prob. 0.9900, 94% HDI: [0.9811,0.9956]
ground-truth: 0, class: 0, mean prob. 0.0016, 94% HDI: [0.0002,0.0062]
ground-truth: 0, class: 0, mean prob. 0.0353, 94% HDI: [0.0106,0.0807]
ground-truth: 1, class: 1, mean prob. 0.9946, 94% HDI: [0.9895,0.9977]
ground-truth: 1, class: 1, mean prob. 0.9849, 94% HDI: [0.9730,0.9926]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 0, mean prob. 0.0301, 94% HDI: [0.0063,0.0850]
ground-truth: 1, class: 1, mean prob. 0.9847, 94% HDI: [0.9734,0.9921]
ground-truth: 0, class: 1, mean prob. 0.5657, 94% HDI: [0.4568,0.6698]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0004]
ground-truth: 1, class: 1, mean prob. 0.9889, 94% HDI: [0.9694,0.9976]
ground-truth: 1, class: 1, mean prob. 0.9894, 94% HDI: [0.9791,0.9958]
ground-truth: 1, class: 1, mean prob. 0.9855, 94% HDI: [0.9744,0.9929]
ground-truth: 1, class: 1, mean prob. 0.9173, 94% HDI: [0.8813,0.9490]
ground-truth: 1, class: 1, mean prob. 0.7938, 94% HDI: [0.6821,0.8791]
ground-truth: 1, class: 1, mean prob. 0.9942, 94% HDI: [0.9886,0.9977]
ground-truth: 0, class: 0, mean prob. 0.0239, 94% HDI: [0.0084,0.0496]
ground-truth: 1, class: 1, mean prob. 0.9968, 94% HDI: [0.9927,0.9990]
ground-truth: 1, class: 1, mean prob. 0.9923, 94% HDI: [0.9856,0.9965]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0005]
ground-truth: 1, class: 1, mean prob. 0.9905, 94% HDI: [0.9817,0.9959]
ground-truth: 1, class: 1, mean prob. 0.9984, 94% HDI: [0.9961,0.9995]
ground-truth: 1, class: 1, mean prob. 0.9861, 94% HDI: [0.9757,0.9933]
ground-truth: 0, class: 0, mean prob. 0.0234, 94% HDI: [0.0072,0.0535]
ground-truth: 1, class: 1, mean prob. 0.9922, 94% HDI: [0.9852,0.9967]
ground-truth: 1, class: 1, mean prob. 0.9979, 94% HDI: [0.9953,0.9992]
ground-truth: 1, class: 1, mean prob. 0.9860, 94% HDI: [0.9739,0.9936]
ground-truth: 0, class: 0, mean prob. 0.0010, 94% HDI: [0.0002,0.0032]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9375, 94% HDI: [0.8843,0.9701]
ground-truth: 1, class: 1, mean prob. 0.9901, 94% HDI: [0.9803,0.9959]
ground-truth: 1, class: 1, mean prob. 0.9241, 94% HDI: [0.8752,0.9587]
ground-truth: 1, class: 1, mean prob. 0.9848, 94% HDI: [0.9737,0.9924]
ground-truth: 1, class: 1, mean prob. 0.9939, 94% HDI: [0.9881,0.9976]
ground-truth: 0, class: 0, mean prob. 0.0097, 94% HDI: [0.0023,0.0253]
ground-truth: 0, class: 1, mean prob. 0.8000, 94% HDI: [0.7174,0.8741]
ground-truth: 1, class: 0, mean prob. 0.2934, 94% HDI: [0.1648,0.4470]
ground-truth: 0, class: 0, mean prob. 0.3755, 94% HDI: [0.2663,0.4853]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0003, 94% HDI: [0.0000,0.0010]
ground-truth: 1, class: 1, mean prob. 0.9927, 94% HDI: [0.9823,0.9978]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 1, class: 1, mean prob. 0.9045, 94% HDI: [0.8533,0.9439]
ground-truth: 1, class: 1, mean prob. 0.9326, 94% HDI: [0.8871,0.9655]
ground-truth: 0, class: 0, mean prob. 0.0259, 94% HDI: [0.0091,0.0564]
ground-truth: 1, class: 1, mean prob. 0.9897, 94% HDI: [0.9812,0.9950]
ground-truth: 1, class: 1, mean prob. 0.9607, 94% HDI: [0.9378,0.9789]
ground-truth: 0, class: 1, mean prob. 0.7105, 94% HDI: [0.6303,0.7879]
ground-truth: 1, class: 1, mean prob. 0.9617, 94% HDI: [0.9180,0.9853]
ground-truth: 1, class: 1, mean prob. 0.9980, 94% HDI: [0.9954,0.9993]
ground-truth: 1, class: 1, mean prob. 0.9649, 94% HDI: [0.9249,0.9869]
ground-truth: 1, class: 0, mean prob. 0.3866, 94% HDI: [0.2471,0.5335]
ground-truth: 0, class: 1, mean prob. 0.9180, 94% HDI: [0.8823,0.9469]
ground-truth: 1, class: 1, mean prob. 0.8027, 94% HDI: [0.7333,0.8640]
ground-truth: 1, class: 1, mean prob. 0.9663, 94% HDI: [0.9433,0.9814]
ground-truth: 0, class: 0, mean prob. 0.1099, 94% HDI: [0.0588,0.1759]
ground-truth: 1, class: 1, mean prob. 0.9667, 94% HDI: [0.9431,0.9831]
ground-truth: 1, class: 1, mean prob. 0.9942, 94% HDI: [0.9879,0.9978]
ground-truth: 0, class: 0, mean prob. 0.1263, 94% HDI: [0.0564,0.2270]
ground-truth: 0, class: 0, mean prob. 0.0027, 94% HDI: [0.0006,0.0076]
ground-truth: 1, class: 1, mean prob. 0.9865, 94% HDI: [0.9756,0.9938]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9723, 94% HDI: [0.9513,0.9860]
ground-truth: 1, class: 1, mean prob. 0.9860, 94% HDI: [0.9685,0.9950]
ground-truth: 1, class: 1, mean prob. 0.9753, 94% HDI: [0.9584,0.9876]
ground-truth: 0, class: 0, mean prob. 0.1303, 94% HDI: [0.0387,0.2776]
ground-truth: 1, class: 1, mean prob. 0.9668, 94% HDI: [0.9413,0.9838]
ground-truth: 1, class: 1, mean prob. 0.9164, 94% HDI: [0.8522,0.9618]
ground-truth: 1, class: 1, mean prob. 0.9954, 94% HDI: [0.9906,0.9982]
ground-truth: 1, class: 1, mean prob. 0.9862, 94% HDI: [0.9757,0.9936]
ground-truth: 1, class: 1, mean prob. 0.9903, 94% HDI: [0.9806,0.9964]
ground-truth: 0, class: 0, mean prob. 0.2028, 94% HDI: [0.1241,0.2935]
ground-truth: 1, class: 1, mean prob. 0.9228, 94% HDI: [0.8878,0.9503]
ground-truth: 1, class: 1, mean prob. 0.9273, 94% HDI: [0.8227,0.9816]
ground-truth: 1, class: 1, mean prob. 0.9990, 94% HDI: [0.9974,0.9997]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0003]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0014, 94% HDI: [0.0002,0.0046]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0002]
ground-truth: 0, class: 0, mean prob. 0.0003, 94% HDI: [0.0000,0.0015]
ground-truth: 1, class: 1, mean prob. 0.9953, 94% HDI: [0.9886,0.9987]
ground-truth: 1, class: 1, mean prob. 0.9881, 94% HDI: [0.9744,0.9957]
ground-truth: 1, class: 1, mean prob. 0.9955, 94% HDI: [0.9889,0.9987]
ground-truth: 0, class: 0, mean prob. 0.2120, 94% HDI: [0.1029,0.3548]
ground-truth: 1, class: 1, mean prob. 0.9946, 94% HDI: [0.9895,0.9977]
ground-truth: 0, class: 1, mean prob. 0.5739, 94% HDI: [0.4602,0.6770]
ground-truth: 1, class: 0, mean prob. 0.4320, 94% HDI: [0.3335,0.5239]
ground-truth: 1, class: 1, mean prob. 0.9875, 94% HDI: [0.9775,0.9938]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9820, 94% HDI: [0.9696,0.9902]
ground-truth: 1, class: 1, mean prob. 0.9558, 94% HDI: [0.9341,0.9729]
ground-truth: 1, class: 1, mean prob. 0.8095, 94% HDI: [0.6862,0.9038]
ground-truth: 1, class: 1, mean prob. 0.9991, 94% HDI: [0.9978,0.9997]
ground-truth: 1, class: 1, mean prob. 0.9960, 94% HDI: [0.9921,0.9984]
ground-truth: 1, class: 1, mean prob. 0.9211, 94% HDI: [0.8839,0.9507]
ground-truth: 1, class: 1, mean prob. 0.9964, 94% HDI: [0.9906,0.9991]
ground-truth: 0, class: 0, mean prob. 0.4563, 94% HDI: [0.3617,0.5555]
ground-truth: 1, class: 1, mean prob. 0.9797, 94% HDI: [0.9657,0.9893]
ground-truth: 1, class: 1, mean prob. 0.9931, 94% HDI: [0.9870,0.9970]
ground-truth: 1, class: 1, mean prob. 0.7366, 94% HDI: [0.6200,0.8417]
ground-truth: 0, class: 1, mean prob. 0.6280, 94% HDI: [0.5361,0.7146]
ground-truth: 1, class: 1, mean prob. 0.9936, 94% HDI: [0.9877,0.9972]
ground-truth: 0, class: 0, mean prob. 0.3583, 94% HDI: [0.2235,0.5218]
ground-truth: 1, class: 1, mean prob. 0.9771, 94% HDI: [0.9359,0.9948]
ground-truth: 1, class: 1, mean prob. 0.9855, 94% HDI: [0.9670,0.9953]
ground-truth: 1, class: 1, mean prob. 0.9174, 94% HDI: [0.8776,0.9485]
ground-truth: 0, class: 0, mean prob. 0.2369, 94% HDI: [0.1443,0.3671]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 1, class: 1, mean prob. 0.8386, 94% HDI: [0.7660,0.8976]
ground-truth: 1, class: 1, mean prob. 0.9982, 94% HDI: [0.9957,0.9994]
ground-truth: 1, class: 1, mean prob. 0.9941, 94% HDI: [0.9880,0.9977]
ground-truth: 0, class: 0, mean prob. 0.0015, 94% HDI: [0.0002,0.0050]
ground-truth: 1, class: 1, mean prob. 0.9538, 94% HDI: [0.9300,0.9724]
ground-truth: 1, class: 1, mean prob. 0.9993, 94% HDI: [0.9982,0.9998]
ground-truth: 0, class: 0, mean prob. 0.0003, 94% HDI: [0.0000,0.0012]
ground-truth: 1, class: 1, mean prob. 0.8153, 94% HDI: [0.7060,0.8985]
ground-truth: 1, class: 1, mean prob. 0.9963, 94% HDI: [0.9923,0.9987]
ground-truth: 0, class: 0, mean prob. 0.0390, 94% HDI: [0.0110,0.0920]
ground-truth: 0, class: 0, mean prob. 0.0058, 94% HDI: [0.0010,0.0181]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.0044, 94% HDI: [0.0010,0.0126]
ground-truth: 1, class: 1, mean prob. 0.9929, 94% HDI: [0.9861,0.9970]
ground-truth: 1, class: 1, mean prob. 0.7798, 94% HDI: [0.7076,0.8479]
ground-truth: 0, class: 0, mean prob. 0.0016, 94% HDI: [0.0003,0.0051]
ground-truth: 1, class: 1, mean prob. 0.9714, 94% HDI: [0.9516,0.9853]
ground-truth: 1, class: 1, mean prob. 0.7219, 94% HDI: [0.6453,0.7954]
ground-truth: 1, class: 1, mean prob. 0.9967, 94% HDI: [0.9933,0.9987]
ground-truth: 0, class: 0, mean prob. 0.4043, 94% HDI: [0.2531,0.5564]
ground-truth: 1, class: 1, mean prob. 0.9727, 94% HDI: [0.9507,0.9871]
ground-truth: 1, class: 1, mean prob. 0.9041, 94% HDI: [0.8216,0.9567]
ground-truth: 1, class: 1, mean prob. 0.9703, 94% HDI: [0.9536,0.9836]
ground-truth: 1, class: 1, mean prob. 0.9926, 94% HDI: [0.9849,0.9971]
ground-truth: 1, class: 1, mean prob. 0.9923, 94% HDI: [0.9853,0.9966]
ground-truth: 0, class: 0, mean prob. 0.1799, 94% HDI: [0.0683,0.3554]
ground-truth: 1, class: 1, mean prob. 0.9912, 94% HDI: [0.9836,0.9960]
ground-truth: 0, class: 0, mean prob. 0.0005, 94% HDI: [0.0001,0.0017]
ground-truth: 1, class: 1, mean prob. 0.9788, 94% HDI: [0.9645,0.9886]
ground-truth: 0, class: 0, mean prob. 0.0012, 94% HDI: [0.0002,0.0042]
ground-truth: 1, class: 1, mean prob. 0.9905, 94% HDI: [0.9831,0.9953]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0008]
ground-truth: 1, class: 1, mean prob. 0.9972, 94% HDI: [0.9942,0.9989]
ground-truth: 1, class: 1, mean prob. 0.9875, 94% HDI: [0.9770,0.9943]
ground-truth: 0, class: 0, mean prob. 0.0005, 94% HDI: [0.0000,0.0025]
ground-truth: 1, class: 1, mean prob. 0.7965, 94% HDI: [0.7145,0.8629]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0003]
ground-truth: 1, class: 1, mean prob. 0.9838, 94% HDI: [0.9708,0.9920]
ground-truth: 1, class: 1, mean prob. 0.9477, 94% HDI: [0.9124,0.9722]
ground-truth: 1, class: 1, mean prob. 0.9910, 94% HDI: [0.9828,0.9961]
ground-truth: 0, class: 0, mean prob. 0.0003, 94% HDI: [0.0000,0.0010]
ground-truth: 1, class: 1, mean prob. 0.9516, 94% HDI: [0.9178,0.9754]
ground-truth: 1, class: 1, mean prob. 0.9845, 94% HDI: [0.9720,0.9928]
ground-truth: 0, class: 0, mean prob. 0.0279, 94% HDI: [0.0073,0.0684]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 1, class: 1, mean prob. 0.9938, 94% HDI: [0.9871,0.9978]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0003]
ground-truth: 0, class: 1, mean prob. 0.7598, 94% HDI: [0.6824,0.8288]
ground-truth: 1, class: 1, mean prob. 0.9980, 94% HDI: [0.9954,0.9993]
ground-truth: 1, class: 1, mean prob. 0.9529, 94% HDI: [0.9238,0.9724]
ground-truth: 1, class: 1, mean prob. 0.9532, 94% HDI: [0.9159,0.9781]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 0, class: 0, mean prob. 0.2698, 94% HDI: [0.1771,0.3712]
ground-truth: 1, class: 1, mean prob. 0.9976, 94% HDI: [0.9946,0.9992]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0002]
ground-truth: 1, class: 1, mean prob. 0.9971, 94% HDI: [0.9935,0.9990]
ground-truth: 1, class: 1, mean prob. 0.7877, 94% HDI: [0.6582,0.8915]
ground-truth: 0, class: 1, mean prob. 0.6273, 94% HDI: [0.4399,0.7810]
ground-truth: 1, class: 1, mean prob. 0.9754, 94% HDI: [0.9597,0.9863]
ground-truth: 1, class: 1, mean prob. 0.9972, 94% HDI: [0.9937,0.9991]
ground-truth: 0, class: 0, mean prob. 0.0009, 94% HDI: [0.0001,0.0033]
ground-truth: 1, class: 0, mean prob. 0.2136, 94% HDI: [0.1145,0.3367]
ground-truth: 1, class: 1, mean prob. 0.9914, 94% HDI: [0.9840,0.9959]
ground-truth: 0, class: 0, mean prob. 0.0039, 94% HDI: [0.0008,0.0109]
ground-truth: 1, class: 1, mean prob. 0.9946, 94% HDI: [0.9877,0.9983]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9876, 94% HDI: [0.9753,0.9951]
ground-truth: 0, class: 1, mean prob. 0.5367, 94% HDI: [0.4448,0.6223]
ground-truth: 0, class: 1, mean prob. 0.9378, 94% HDI: [0.9065,0.9615]
ground-truth: 1, class: 1, mean prob. 0.9602, 94% HDI: [0.9296,0.9815]
ground-truth: 1, class: 1, mean prob. 0.9630, 94% HDI: [0.9091,0.9898]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0002]
ground-truth: 0, class: 1, mean prob. 0.6704, 94% HDI: [0.5819,0.7503]
ground-truth: 1, class: 1, mean prob. 0.7970, 94% HDI: [0.7239,0.8607]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0003]
ground-truth: 0, class: 0, mean prob. 0.0002, 94% HDI: [0.0000,0.0008]
ground-truth: 1, class: 1, mean prob. 0.8595, 94% HDI: [0.6728,0.9635]
ground-truth: 1, class: 0, mean prob. 0.4895, 94% HDI: [0.3299,0.6426]
ground-truth: 1, class: 1, mean prob. 0.9811, 94% HDI: [0.9681,0.9901]
ground-truth: 0, class: 0, mean prob. 0.0535, 94% HDI: [0.0217,0.1035]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0000]
ground-truth: 1, class: 1, mean prob. 0.9833, 94% HDI: [0.9710,0.9916]
ground-truth: 1, class: 1, mean prob. 0.8763, 94% HDI: [0.8223,0.9185]
ground-truth: 1, class: 1, mean prob. 0.9852, 94% HDI: [0.9737,0.9928]
ground-truth: 1, class: 1, mean prob. 0.8918, 94% HDI: [0.8488,0.9283]
ground-truth: 0, class: 1, mean prob. 0.8871, 94% HDI: [0.8285,0.9310]
ground-truth: 0, class: 1, mean prob. 0.7482, 94% HDI: [0.6645,0.8231]
ground-truth: 1, class: 1, mean prob. 0.9475, 94% HDI: [0.9130,0.9731]
ground-truth: 1, class: 1, mean prob. 0.9871, 94% HDI: [0.9762,0.9938]
ground-truth: 0, class: 0, mean prob. 0.3291, 94% HDI: [0.2270,0.4502]
ground-truth: 1, class: 1, mean prob. 0.9499, 94% HDI: [0.9031,0.9776]
ground-truth: 1, class: 1, mean prob. 0.9718, 94% HDI: [0.9547,0.9841]
ground-truth: 0, class: 0, mean prob. 0.0110, 94% HDI: [0.0035,0.0243]
ground-truth: 1, class: 1, mean prob. 0.9966, 94% HDI: [0.9927,0.9988]
ground-truth: 1, class: 1, mean prob. 0.9912, 94% HDI: [0.9822,0.9963]
ground-truth: 1, class: 1, mean prob. 0.8990, 94% HDI: [0.8318,0.9477]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0006]
ground-truth: 1, class: 1, mean prob. 0.9886, 94% HDI: [0.9786,0.9947]
=======================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Accuracy</span>
<span class="n">accuracy_train</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">yv_train</span><span class="p">,</span> <span class="n">class_assignments_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy_train</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate Confusion Matrix</span>
<span class="n">conf_matrix_train</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">yv_train</span><span class="p">,</span> <span class="n">class_assignments_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="si">{</span><span class="n">conf_matrix_train</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.9154929577464789
Confusion Matrix:
[[135  23]
 [ 13 255]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="isolate-the-misidentified-events">
<h3>Isolate the misidentified events<a class="headerlink" href="#isolate-the-misidentified-events" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find indices where the prediction and the ground truth don&#39;t match</span>
<span class="n">mismatch_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">yv_test</span> <span class="o">!=</span> <span class="n">class_assignments</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the mismatched events</span>
<span class="n">mismatched_events_true</span> <span class="o">=</span> <span class="n">yv_test</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
<span class="n">mismatched_events_class</span> <span class="o">=</span> <span class="n">class_assignments</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
<span class="n">mismatched_events_prob</span> <span class="o">=</span> <span class="n">mean_probabilities</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
<span class="n">mismatched_events_low</span> <span class="o">=</span> <span class="n">lower_bound</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
<span class="n">mismatched_events_up</span> <span class="o">=</span> <span class="n">upper_bound</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MISMATCHED TEST DATA: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xv_train</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;class, probabilities, ranges(94%HDI): &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mismatch_indices</span><span class="p">,</span> <span class="n">mismatched_events_true</span><span class="p">,</span> <span class="n">mismatched_events_class</span><span class="p">,</span> <span class="n">mismatched_events_prob</span><span class="p">,</span> \
                     <span class="n">mismatched_events_low</span><span class="p">,</span> <span class="n">mismatched_events_up</span> <span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index: </span><span class="si">{</span><span class="n">f</span><span class="si">:</span><span class="s2">4</span><span class="si">}</span><span class="s2">, ground-truth: </span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">, class: </span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s2">, mean prob. </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, 94% HDI: [</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=======================================
MISMATCHED TEST DATA: 
 [[1.154e+01 2.031e+01 1.136e+01 ... 1.205e+01 2.044e+01 1.174e+01]
 [1.444e+01 2.706e+01 1.757e+01 ... 2.272e+01 2.178e+01 1.469e+01]
 [7.465e+01 1.329e+02 7.249e+01 ... 7.875e+01 1.338e+02 7.631e+01]
 ...
 [2.594e-02 9.333e-02 2.100e-02 ... 2.978e-02 7.785e-02 2.639e-02]
 [1.818e-01 1.814e-01 1.601e-01 ... 1.203e-01 1.618e-01 1.499e-01]
 [6.782e-02 5.572e-02 5.913e-02 ... 6.659e-02 5.557e-02 6.758e-02]]
=======================================

class, probabilities, ranges(94%HDI): 
index:    7, ground-truth: 0, class: 1, mean prob. 0.9876, 94% HDI: [0.9773,0.9938]
index:   21, ground-truth: 0, class: 1, mean prob. 0.9401, 94% HDI: [0.9092,0.9642]
index:   30, ground-truth: 0, class: 1, mean prob. 0.7574, 94% HDI: [0.6417,0.8530]
index:   40, ground-truth: 0, class: 1, mean prob. 0.5834, 94% HDI: [0.4833,0.6747]
index:   42, ground-truth: 0, class: 1, mean prob. 0.5778, 94% HDI: [0.4193,0.7278]
index:   72, ground-truth: 0, class: 1, mean prob. 0.6508, 94% HDI: [0.5463,0.7520]
index:   90, ground-truth: 0, class: 1, mean prob. 0.6332, 94% HDI: [0.5319,0.7185]
index:  120, ground-truth: 1, class: 0, mean prob. 0.4691, 94% HDI: [0.3239,0.6180]
index:  133, ground-truth: 0, class: 1, mean prob. 0.5708, 94% HDI: [0.4547,0.6788]
=======================================
</pre></div>
</div>
</div>
</div>
</section>
<section id="filtering-those-events">
<h3>Filtering those events<a class="headerlink" href="#filtering-those-events" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">uncertain_events</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">133</span><span class="p">]</span>
<span class="n">uncertain_events</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">uncertain_events</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">yv_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">yv_test</span><span class="p">))</span>

<span class="c1"># Create a boolean mask</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">yv_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>  <span class="c1"># Initialize mask with True</span>
<span class="n">mask</span><span class="p">[</span><span class="n">uncertain_events</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Set False for indices in mismatch_indices</span>


<span class="c1"># Filter the data</span>
<span class="n">filtered_yv_test</span> <span class="o">=</span> <span class="n">yv_test</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">filtered_xv_test</span> <span class="o">=</span> <span class="n">xv_test</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">filtered_events_class</span> <span class="o">=</span> <span class="n">class_assignments</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">filtered_events_prob</span> <span class="o">=</span> <span class="n">mean_probabilities</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">filtered_events_low</span> <span class="o">=</span> <span class="n">lower_bound</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">filtered_events_up</span> <span class="o">=</span> <span class="n">upper_bound</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.ndarray&#39;&gt; (143,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Accuracy</span>
<span class="n">accuracy_filter</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">filtered_yv_test</span><span class="p">,</span> <span class="n">filtered_events_class</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy_filter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate Confusion Matrix</span>
<span class="n">conf_matrix_filter</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">filtered_yv_test</span><span class="p">,</span> <span class="n">filtered_events_class</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="si">{</span><span class="n">conf_matrix_train</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.9640287769784173
Confusion Matrix:
[[135  23]
 [ 13 255]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-pca">
<h3>Using PCA<a class="headerlink" href="#using-pca" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standardize the data</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">x_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="n">x_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>

<span class="c1"># PCA transformation</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_train_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train_scaled</span><span class="p">)</span>
<span class="n">x_test_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">)</span>
<span class="n">expl_var</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
<span class="nb">print</span><span class="p">(</span><span class="n">expl_var</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_train_scaled</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5.40185459 2.6218337 ]
[0.53891742 0.26156792]
0.9999999999999998
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">model_pca</span><span class="p">:</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">betas</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;betas&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span> <span class="n">x_train_pca</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">logits</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_train_pca</span><span class="p">,</span> <span class="n">betas</span><span class="p">)</span>


    <span class="n">theta</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Deterministic</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">pm</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">logits</span><span class="p">)))</span>
    <span class="n">bd</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Deterministic</span><span class="p">(</span><span class="s1">&#39;bd&#39;</span><span class="p">,</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="n">betas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">betas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">betas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_train_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>


    <span class="n">yl</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Bernoulli</span><span class="p">(</span><span class="s1">&#39;yl&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>

    <span class="n">trace_pca</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">target_accept</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
<div>
  <progress value='3000' class='' max='3000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [3000/3000 00:05&lt;00:00 Sampling chain 0, 0 divergences]
</div>
</div><div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
<div>
  <progress value='3000' class='' max='3000' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [3000/3000 00:04&lt;00:00 Sampling chain 1, 0 divergences]
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace_pca</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-8c4ad586-a8a5-4563-9dfa-cbf4b2667d29" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alpha</th>
      <td>0.563</td>
      <td>0.212</td>
      <td>0.161</td>
      <td>0.951</td>
      <td>0.005</td>
      <td>0.004</td>
      <td>1610.0</td>
      <td>1432.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>betas[0]</th>
      <td>-2.489</td>
      <td>0.297</td>
      <td>-3.016</td>
      <td>-1.901</td>
      <td>0.008</td>
      <td>0.006</td>
      <td>1340.0</td>
      <td>1294.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>betas[1]</th>
      <td>0.789</td>
      <td>0.164</td>
      <td>0.465</td>
      <td>1.065</td>
      <td>0.004</td>
      <td>0.003</td>
      <td>1385.0</td>
      <td>1183.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>theta[0]</th>
      <td>0.989</td>
      <td>0.006</td>
      <td>0.977</td>
      <td>0.998</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1283.0</td>
      <td>1044.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>theta[1]</th>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.001</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>1243.0</td>
      <td>1188.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>bd[421]</th>
      <td>-6.825</td>
      <td>1.280</td>
      <td>-9.212</td>
      <td>-4.726</td>
      <td>0.028</td>
      <td>0.020</td>
      <td>2044.0</td>
      <td>1554.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>bd[422]</th>
      <td>-4.389</td>
      <td>0.860</td>
      <td>-5.972</td>
      <td>-2.989</td>
      <td>0.019</td>
      <td>0.014</td>
      <td>1913.0</td>
      <td>1609.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>bd[423]</th>
      <td>-6.174</td>
      <td>1.167</td>
      <td>-8.342</td>
      <td>-4.251</td>
      <td>0.026</td>
      <td>0.018</td>
      <td>2027.0</td>
      <td>1554.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>bd[424]</th>
      <td>6.131</td>
      <td>1.126</td>
      <td>4.311</td>
      <td>8.212</td>
      <td>0.023</td>
      <td>0.016</td>
      <td>2331.0</td>
      <td>1667.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>bd[425]</th>
      <td>-6.511</td>
      <td>1.225</td>
      <td>-8.784</td>
      <td>-4.513</td>
      <td>0.027</td>
      <td>0.019</td>
      <td>2036.0</td>
      <td>1554.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>855 rows Ã— 9 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8c4ad586-a8a5-4563-9dfa-cbf4b2667d29')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8c4ad586-a8a5-4563-9dfa-cbf4b2667d29 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8c4ad586-a8a5-4563-9dfa-cbf4b2667d29');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-24bb6076-b6cd-4c8d-a2b9-ce5f25dbe968">
  <button class="colab-df-quickchart" onclick="quickchart('df-24bb6076-b6cd-4c8d-a2b9-ce5f25dbe968')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-24bb6076-b6cd-4c8d-a2b9-ce5f25dbe968 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace_pca</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;alpha&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;alpha&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;betas&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;betas&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;theta&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;theta&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;bd&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;bd&#39;}&gt;]],
      dtype=object)
</pre></div>
</div>
<img alt="_images/Sol_assignment2_52_1.png" src="_images/Sol_assignment2_52_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alpha_chain_pca</span> <span class="o">=</span> <span class="n">trace_pca</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">betas_chain_pca</span> <span class="o">=</span> <span class="n">trace_pca</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;betas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">alpha_chain_pca</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">betas_chain_pca</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1000,) (1000, 2)
</pre></div>
</div>
</div>
</div>
</section>
<section id="analysis-on-standardized-and-pca-reduced-data">
<h3>Analysis on standardized and PCA-reduced data<a class="headerlink" href="#analysis-on-standardized-and-pca-reduced-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logit_pca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_test_pca</span><span class="p">,</span> <span class="n">betas_chain_pca</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">alpha_chain_pca</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">logit_pca</span><span class="p">))</span>

<span class="n">probabilities_pca</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">logit_pca</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">probabilities_pca</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(143, 1000)
(143, 1000)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Average probabilities for prediction</span>
<span class="n">mean_probabilities_pca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">probabilities_pca</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Class assignment (you might adjust the threshold if needed, default is 0.5)</span>
<span class="n">class_assignments_pca</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean_probabilities_pca</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Uncertainty estimation</span>
<span class="n">lower_bound_pca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">probabilities_pca</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">upper_bound_pca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">probabilities_pca</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TEST DATA (after stanardization and PCA-reduced): </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">x_test_pca</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;class, probabilities, ranges(94%HDI): &quot;</span><span class="p">)</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">yv_test</span><span class="p">,</span> <span class="n">class_assignments_pca</span><span class="p">,</span> <span class="n">mean_probabilities_pca</span><span class="p">,</span> <span class="n">lower_bound_pca</span><span class="p">,</span> <span class="n">upper_bound_pca</span><span class="p">):</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">count</span><span class="o">%</span><span class="mi">20</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ground-truth: </span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">, class: </span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s2">, mean prob. </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, 94% HDI: [</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
  <span class="n">count</span> <span class="o">=</span> <span class="n">count</span><span class="o">+</span><span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=======================================
TEST DATA (after stanardization and PCA-reduced): 
 [[-2.68765349 -2.5113037   1.01084219 -2.83111171  2.16544047  0.37694912
  -0.91817304 -1.68999278 -1.24530946  0.12623048 -2.38243235  1.90388123
   2.31888898 -2.27683002  2.83808936 -1.03028813 -2.29880578 -1.89687777
  -0.52039147 -1.30806695  4.36476664 -1.20633777 -1.33057932 -2.81543489
  -2.09760325  1.34545564  1.2317508  -1.91466512  0.44382841 -2.43543411
   1.28886213 -2.03699266 -1.28565306 -1.87007999  1.38979878 -2.2149903
  -0.99558582 -1.9069201  -2.10892453  2.78043943 -0.59618023 -1.71318561
   1.40232197 -0.59737643  0.8066522   0.17532421  4.02489799  7.51919622
   0.41079628  0.56903517  0.9351951   2.51774498 -0.71395051 -1.75754436
  -1.46500693  1.91261772 -1.52280955  3.52478866  4.13148745 -0.05593647
   4.92138927 -1.99454432 -1.10275494 -2.68566393 -0.73253818  7.77540963
  -2.67319268 -2.42506682 -1.12459722  0.43761454 -2.13246376 -2.04942915
  -0.39346898 -1.73509426 -0.01507782 -1.28842198 -0.5076413   4.31797969
   2.93628467  0.41471032 -0.28923594  1.67405133  2.92041367 -3.2609447
  -1.91768304 -2.04615302  2.0778711  -2.78127963  1.33931947 -1.54511781
   0.45081405 -1.38512919 -2.24308444  7.04517983 -1.4844696  -1.320075
  -1.06346831 -0.29988115 -1.10189236 -2.14063483 -1.74381292 -3.294123
  -1.21712346  0.22593737 -1.9337784  -3.02748172 -2.52695222 -1.26940837
  -2.41894358 -2.36448211 -3.45683486 -2.17811665 -2.07411438  2.60353705
   2.46462643  1.4679766  -1.74058593  2.79006312 -2.66861009 -0.69822168
  -0.2719495  -1.34396012 -2.3787894  -1.01556348  1.3896027  -0.33650935
   2.31255672  1.65456802 -1.69979833 -1.08656399  2.26569582 -2.72317747
  -2.85298563  0.47046889  1.90461237 -2.50982825 -1.34581768 -1.76283834
   2.86509754  2.78115429  4.38451616 -1.33134025  4.96953382]
 [-0.13611386  0.95862029 -1.91138315 -2.66288919 -0.72687977  0.38068157
   0.73713249  0.16453986 -1.80588348  2.40644672 -2.39874421 -0.51994523
   3.46739654 -0.83776882  1.3526116   0.26203505 -1.47888575 -0.55682945
   1.46265634  0.42854629 -1.98123104 -0.97801068 -0.87606965 -0.34930916
  -1.78494657 -0.90205228 -0.18292576 -0.07100387 -1.3986182   0.17726552
   3.22734351  1.34390113 -0.82187766  0.03418315  1.14438434 -0.77389129
  -0.99500946 -0.27751414 -0.99625037 -1.15343472 -1.41878682 -1.14861194
   0.84906373  0.72577427 -0.30001375  1.95294978 -0.92631825 -3.61025602
  -1.63897296  0.3996528   1.30361704 -3.11394172 -0.5566169  -0.53594595
  -0.81247219 -0.1500986   0.13347942 -3.31513936 -0.2582219   0.34122947
   1.7964115   0.03504414  1.1989128   0.39658141  1.0002434  -1.31888061
  -0.70000003 -1.2955354   3.41222897 -0.01454769  0.76648645  0.40705628
  -0.91087231 -1.49768481 -1.32694016  0.61004128  0.49457419 -1.70935433
   0.0558852  -2.50481596  1.08874529  0.51580252 -1.19841172 -0.90495962
  -0.25518624  1.03110911  1.65382569 -1.1361806  -0.01015888 -0.7460224
   1.18136689  0.02008071 -0.66894711 -0.91765443 -0.8289278   0.86895531
  -0.44478576  1.246291    1.4627026   1.36416819 -0.73090161  1.09375715
   0.20344261  1.23349178  0.14905164  1.77015587 -0.24862147  1.24576249
   2.50472344 -0.66023141 -0.29824417 -1.63495898 -0.42969605  0.12544955
   2.66458765 -1.82423955 -0.2261428   1.65936891 -0.9825544   0.41298155
  -0.64520053  1.03944042 -0.9356033   0.43087011 -0.9606564   0.94981272
   2.03762753  2.10182937 -0.23322591 -0.1132355   0.27211702 -1.75383072
   0.02007179  1.1177642   0.40762721  0.60242354 -1.53698874  0.13716864
   0.64051868 -0.93970368 -0.59959434  0.04264858 -2.13138555]]
=======================================

class, probabilities, ranges(94%HDI): 
ground-truth: 1, class: 1, mean prob. 0.9991, 94% HDI: [0.9977,0.9998]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
ground-truth: 0, class: 1, mean prob. 0.7147, 94% HDI: [0.6275,0.7923]
ground-truth: 0, class: 0, mean prob. 0.0001, 94% HDI: [0.0000,0.0002]
ground-truth: 1, class: 1, mean prob. 0.8930, 94% HDI: [0.8476,0.9310]
ground-truth: 1, class: 1, mean prob. 0.9861, 94% HDI: [0.9753,0.9937]
ground-truth: 1, class: 1, mean prob. 0.6739, 94% HDI: [0.5983,0.7442]
ground-truth: 0, class: 0, mean prob. 0.0000, 94% HDI: [0.0000,0.0001]
=======================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Accuracy</span>
<span class="n">accuracy_pca</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">yv_test</span><span class="p">,</span> <span class="n">class_assignments_pca</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy_pca</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate Confusion Matrix</span>
<span class="n">conf_matrix_pca</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">yv_test</span><span class="p">,</span> <span class="n">class_assignments_pca</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="si">{</span><span class="n">conf_matrix_pca</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.951048951048951
Confusion Matrix:
[[48  6]
 [ 1 88]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization-of-uncertainty-band">
<h3>Visualization of Uncertainty Band<a class="headerlink" href="#visualization-of-uncertainty-band" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x_train_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>


<span class="n">bd_mean</span> <span class="o">=</span> <span class="n">trace_pca</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;bd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_train_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_train_pca</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;C</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">yv_train</span><span class="p">])</span>

<span class="n">bd</span> <span class="o">=</span> <span class="n">bd_mean</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span> <span class="n">bd</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>


<span class="n">az</span><span class="o">.</span><span class="n">plot_hdi</span><span class="p">(</span><span class="n">x_train_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">trace_pca</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;bd&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;PCA1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PCA2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;training data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;training data&#39;)
</pre></div>
</div>
<img alt="_images/Sol_assignment2_59_1.png" src="_images/Sol_assignment2_59_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bd_mean</span> <span class="o">=</span> <span class="n">trace_pca</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;bd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_test_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_test_pca</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;C</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">yv_test</span><span class="p">])</span>

<span class="n">bd</span> <span class="o">=</span> <span class="n">bd_mean</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span> <span class="n">bd</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">);</span>


<span class="n">az</span><span class="o">.</span><span class="n">plot_hdi</span><span class="p">(</span><span class="n">x_train_pca</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">trace_pca</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;bd&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;PCA1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PCA2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Test Data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Test Data&#39;)
</pre></div>
</div>
<img alt="_images/Sol_assignment2_60_1.png" src="_images/Sol_assignment2_60_1.png" />
</div>
</div>
</section>
<section id="filtering-events">
<h3>Filtering Events<a class="headerlink" href="#filtering-events" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find indices where the prediction and the ground truth don&#39;t match</span>
<span class="n">mismatch_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">yv_test</span> <span class="o">!=</span> <span class="n">class_assignments_pca</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mismatch_indices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  5   7  21  40  72  90 133]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the mismatched events</span>
<span class="n">mismatched_events_true_pca</span> <span class="o">=</span> <span class="n">yv_test</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
<span class="n">mismatched_events_class_pca</span> <span class="o">=</span> <span class="n">class_assignments_pca</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
<span class="n">mismatched_events_prob_pca</span> <span class="o">=</span> <span class="n">mean_probabilities_pca</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
<span class="n">mismatched_events_low_pca</span> <span class="o">=</span> <span class="n">lower_bound_pca</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
<span class="n">mismatched_events_up_pca</span> <span class="o">=</span> <span class="n">upper_bound_pca</span><span class="p">[</span><span class="n">mismatch_indices</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=======================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MISMATCHED TEST DATA (after PCA): </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xv_train</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;class, probabilities, ranges(94%HDI): &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mismatch_indices</span><span class="p">,</span> <span class="n">mismatched_events_true_pca</span><span class="p">,</span> <span class="n">mismatched_events_class_pca</span><span class="p">,</span> <span class="n">mismatched_events_prob_pca</span><span class="p">,</span> \
                     <span class="n">mismatched_events_low_pca</span><span class="p">,</span> <span class="n">mismatched_events_up_pca</span> <span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index: </span><span class="si">{</span><span class="n">f</span><span class="si">:</span><span class="s2">4</span><span class="si">}</span><span class="s2">, ground-truth: </span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">, class: </span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="s2">, mean prob. </span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, 94% HDI: [</span><span class="si">{</span><span class="n">j</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=======================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=======================================
MISMATCHED TEST DATA (after PCA): 
 [[1.154e+01 2.031e+01 1.136e+01 ... 1.205e+01 2.044e+01 1.174e+01]
 [1.444e+01 2.706e+01 1.757e+01 ... 2.272e+01 2.178e+01 1.469e+01]
 [7.465e+01 1.329e+02 7.249e+01 ... 7.875e+01 1.338e+02 7.631e+01]
 ...
 [2.594e-02 9.333e-02 2.100e-02 ... 2.978e-02 7.785e-02 2.639e-02]
 [1.818e-01 1.814e-01 1.601e-01 ... 1.203e-01 1.618e-01 1.499e-01]
 [6.782e-02 5.572e-02 5.913e-02 ... 6.659e-02 5.557e-02 6.758e-02]]
=======================================

class, probabilities, ranges(94%HDI): 
index:    5, ground-truth: 1, class: 0, mean prob. 0.4813, 94% HDI: [0.4014,0.5575]
index:    7, ground-truth: 0, class: 1, mean prob. 0.9920, 94% HDI: [0.9847,0.9968]
index:   21, ground-truth: 0, class: 1, mean prob. 0.9407, 94% HDI: [0.9093,0.9652]
index:   40, ground-truth: 0, class: 1, mean prob. 0.7147, 94% HDI: [0.6275,0.7923]
index:   72, ground-truth: 0, class: 1, mean prob. 0.6937, 94% HDI: [0.6163,0.7643]
index:   90, ground-truth: 0, class: 1, mean prob. 0.5914, 94% HDI: [0.5029,0.6751]
index:  133, ground-truth: 0, class: 1, mean prob. 0.5674, 94% HDI: [0.4797,0.6527]
=======================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">uncertain_events_pca</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">133</span><span class="p">]</span>
<span class="n">uncertain_events_pca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">uncertain_events_pca</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">yv_test</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">yv_test</span><span class="p">))</span>

<span class="c1"># Create a boolean mask</span>
<span class="n">mask_pca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">yv_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>  <span class="c1"># Initialize mask with True</span>
<span class="n">mask_pca</span><span class="p">[</span><span class="n">uncertain_events_pca</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Set False for indices in mismatch_indices</span>


<span class="c1"># Filter the data</span>
<span class="n">filtered_yv_test_pca</span> <span class="o">=</span> <span class="n">yv_test</span><span class="p">[</span><span class="n">mask_pca</span><span class="p">]</span>
<span class="n">filtered_xv_test_pca</span> <span class="o">=</span> <span class="n">x_test_pca</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">mask_pca</span><span class="p">]</span>
<span class="n">filtered_events_class_pca</span> <span class="o">=</span> <span class="n">class_assignments_pca</span><span class="p">[</span><span class="n">mask_pca</span><span class="p">]</span>
<span class="n">filtered_events_prob_pca</span> <span class="o">=</span> <span class="n">mean_probabilities_pca</span><span class="p">[</span><span class="n">mask_pca</span><span class="p">]</span>
<span class="n">filtered_events_low_pca</span> <span class="o">=</span> <span class="n">lower_bound_pca</span><span class="p">[</span><span class="n">mask_pca</span><span class="p">]</span>
<span class="n">filtered_events_up_pca</span> <span class="o">=</span> <span class="n">upper_bound_pca</span><span class="p">[</span><span class="n">mask_pca</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.ndarray&#39;&gt; (143,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Ple</span><span class="c1"># Calculate Accuracy</span>
<span class="n">accuracy_pca_filter</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">filtered_yv_test_pca</span><span class="p">,</span> <span class="n">filtered_events_class_pca</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy_pca_filter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate Confusion Matrix</span>
<span class="n">conf_matrix_pca_filter</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">filtered_yv_test_pca</span><span class="p">,</span> <span class="n">filtered_events_class_pca</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="si">{</span><span class="n">conf_matrix_pca</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.9645390070921985
Confusion Matrix:
[[48  6]
 [ 1 88]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "cfteach/BRDS_DATA644",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Sol_assignment1.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">DATA 644 (Bayesian Reasoning in Data Science): Assignment 1</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="referencesmd.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">References</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Cristiano Fanelli<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>